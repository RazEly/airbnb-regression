__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.queryToOperationOptions=function(t){return{type:'graphql',operation:t.query,variables:void 0,fetchPolicy:'cache-first',dedupePolicy:'dedupe-inflight',usePOSTForQuery:!1,context:{},skip:!1,deferrable:!1,headers:{},...t}}},"043517",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;function n(){const t=r(d[1]);return n=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.logAirlockLifecycleEvent=function(t,_){const v=(0,c.isLegacyAirlock)(_),E=(0,c.getAirlockId)(_)??void 0;if(!E)return;o.default.logJitneyEvent({schema:n().AirlockPlatformAirlockLifecycleEvent,event_data:{event_type:l[t],event_data:{airlock_id:E},lifecycle_event_meta:{platform_version:v?'v1':'v2'}}})};var c=r(d[2]),o=t(r(d[3]));const l={RECEIVED_BY_FRONTEND:3,FULL_PAGE_REDIRECT:4,REQUEST_REPLAYED:18}},"0876d7",["ba7a76","a4ed0f","1700a4","c8b97a"]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(){const n=r(d[0]);return t=function(){return n},n}Object.defineProperty(e,"__esModule",{value:!0}),e.timeoutSignalTransform=function(n){const{timeout:o,multiAbortController:u}=n,c=(0,t().createTimeoutSignal)(o);c&&u.addSufficientSignal(c);return n}},"096956",["a9e08c"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.skipResolver=function(s){if(s.skip)return t};const t={data:void 0,skip:!0}},"0c3d76",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.extractAirlockData=function(c){const n=(0,o.extractClientErrorInfo)(c);if(n?.airlock){const{airlock:o}=n;return{airlock:o,platformVersion:'v1',airlockId:o.airlockId,viewName:(0,t.extractViewName)(o,'v1')}}if(n?.airlockV2){const{airlockV2:o}=n;return{airlock:o,platformVersion:'v2',airlockId:o.internalAirlockId,viewName:(0,t.extractViewName)(o,'v2')}}return{platformVersion:'none'}};var o=r(d[0]),t=r(d[1])},"10dcf3",["e056b2","8cd0d8"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return(0,n.openSignupOrLoginModal)({authTriggerType:o.AuthTriggerTypes.RECAPTCHA,onFinishedFlow:()=>window.location.reload(),onModalClose:()=>window.location.reload()})};var o=r(d[0]),n=r(d[1])},"178cf3",["5eb3f8","4798c3"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getKeyPathValue=function(t,u){return u[t]}},"1e477a",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var o=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.handleAirlockError=function({extractedData:o,onAirlockHandled:l,error:n,niobeClient:u,logger:c,fetchUrl:s}){if(!o.airlock)return;t.default.emit('airlock:niobe:trigger',{airlock:o.airlock,onSuccess:()=>{if(c.logRetryCount(o,!0),'v1'===o.platformVersion&&!o.airlock.should_replay_request)return c.logRequestNotReplayed(o,s),void l(!1);c.logRequestReplayed(o,s),l(!0)},onError:()=>{c.logRetryCount(o,!1),c.logRequestNotReplayed(o,s),l(!1)},error:n,niobeClient:u})};var t=o(r(d[1]))},"1fbf90",["ba7a76","abc3e4"]);
__d(function(g,r,i,a,m,e,d){"use strict";function o(){const n=r(d[0]);return o=function(){return n},n}Object.defineProperty(e,"__esModule",{value:!0}),e.redirectToAirlockIfGhostingAppeal=function(o,s){const c=t(o);return!!c&&(s.logRetrierCancelled({platformVersion:'none'},'ghostingAppeal'),(0,n.redirectToUrl)(c),!0)};var n=r(d[1]);function t(n){if(n.error?.graphQLErrors&&o().NiobeError.isGraphQLErrors(n?.error))for(const o of n.error.cause){const n=o.extensions?.response?.body?.ghostingAppeal?.redirectUri;if(n)return n}}},"24be2a",["00dfad","8bd668"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.airlockRetrier=void 0;var o=r(d[0]),t=r(d[1]),c=r(d[2]),l=r(d[3]),n=r(d[4]),k=r(d[5]);e.airlockRetrier=({result:s,metricReporter:f,jitneyLogger:A,flagger:p,options:u,niobeClient:v})=>{const R=new o.AirlockNiobeLogger({jitneyLogger:A,metricReporter:f,flagger:p});if((0,k.redirectToAirlockIfGhostingAppeal)(s,R))return;const h=(0,l.extractAirlockData)(s);return h.airlock&&(R.logReceived(h,u?.fetchUrl),!(0,n.redirectToAirlockIfFullpage)(h,R))?{context:new Promise(o=>{(0,c.handleAirlockError)({extractedData:h,onAirlockHandled:c=>{o(c?{fetchOptions:{headers:{[t.AIRLOCK_REPLAY_HEADER]:h.airlockId??''}},airlockView:h.viewName??void 0}:void 0)},error:s,niobeClient:v,logger:R,fetchUrl:u?.fetchUrl})}),reason:'airlock'}:void 0}},"24eb52",["924b00","f3d6f1","1fbf90","10dcf3","9f2c9e","24be2a"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.extractGraphqlAirlockError=function(n){return n?.map(t=>t.extensions?.response?.body).map(t.extractAirlockData).find(t=>null!=t)};var t=r(d[0])},"29bae5",["1700a4"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parseServerTiming=function(t){if(!t)return;return t.split(',').map(t=>t.trim()).reduce((t,n)=>{const[s,...u]=n.split(';'),c=s.trim().replaceAll(/"/g,''),l={};return u.forEach(t=>{if(!t.includes('='))return;const[n,s]=t.trim().split('=');if(!n)return;const u=parseFloat(s);Number.isNaN(u)?l[n]=s.replace(/^"|"$/g,''):l[n]=u}),c&&(t[c]=l),t},{})}},"2f6e7b",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var n=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.agentFrictionRetrier=void 0;var t=n(r(d[1])),o=r(d[2]),c=n(r(d[3]));e.agentFrictionRetrier=({flagger:n,result:u,niobeClient:l})=>{if(!n.isTrebuchetLaunched((0,t.default)('csp.niobe.agent_friction_retrier.enabled')))return;const s=(0,c.default)(u);return null!==s?{context:new Promise(n=>{(0,o.handleAgentFriction)({friction:s,onSuccess:()=>{n({})},onError:()=>{n(undefined)},niobeClient:l})}),reason:'agentFriction'}:void 0}},"2f7cf3",["ba7a76","2c6bf9","eebdbf","8be4f5"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.redirectToAirlockIfFullpage=function(f,k){if((0,c.isFullpage)(f)){const s=(0,l.isLegacyAirlock)(f);if(k){const l=(0,t.extractViewName)(f,s);(0,n.logRetrierCancelled)(k,'fullpageRedirect',s,l)}return s?(0,u.redirectToAirlock)((0,c.getFullpageURL)(f)):((0,o.logAirlockLifecycleEvent)('FULL_PAGE_REDIRECT',f),(0,u.redirectToAirlock)(`/airlock/${f.internalAirlockId}`)),!0}return!1};var l=r(d[0]),c=r(d[1]),t=r(d[2]),o=r(d[3]),n=r(d[4]),u=r(d[5])},"31ec22",["1700a4","6cfeca","417c98","94a171","7ad8b2","c49192"]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(){const n=r(d[0]);return t=function(){return n},n}Object.defineProperty(e,"__esModule",{value:!0}),e.computeOperationCacheKey=function(n,c={}){return`${n.name}:${JSON.stringify((0,t().convertToStableObjectOrder)(c))}`}},"34be0f",["fad99e"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.extractViewName=function(t,n){let l=null;if(n){const{friction_data:n}=t;l=(n||[])[0]?.name||null}else{const{viewPayload:n}=t;l='AirlockFlowViewPayload'===n?.__typename?n.flowView:n.frictionView}return l}},"417c98",[]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(){const n=r(d[0]);return t=function(){return n},n}Object.defineProperty(e,"__esModule",{value:!0}),e.abortSignalTransform=function(n){const{signal:o,multiAbortController:l=new(t().MultiAbortController)}=n;o&&l.addSignal(o);return{...n,multiAbortController:l}}},"41c843",["b3b435"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.clearInflightQuery=function(t,o){'dedupe-inflight'===o.dedupePolicy&&t.delete(o.key)},e.inflightQueryResolver=function(t,o){const{multiAbortController:l,dedupePolicy:n,key:u}=o;if('dedupe-inflight'!==n)return;const c=t.get(u);if(!c)return;const{promise:s,multiAbortController:f}=c;return f.addSignal(l.signal),s},e.storeInflightQuery=function(t,o,l){const{multiAbortController:n,dedupePolicy:u,key:c}=o;'dedupe-inflight'!==u||t.has(c)||t.set(o.key,{promise:l,multiAbortController:n})}},"459e51",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.formatUrl=function(s,n){const c=new URL(s,s.startsWith('http')?void 0:t);n&&new URLSearchParams(n).forEach((t,s)=>c.searchParams.append(s,t));const o=c.toString();return o.startsWith(t)?o.slice(t.length):o};const t='https://__example__.com'},"45f45a",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.getBotDetectionConfigForUrl=void 0;var o=t(r(d[1]));e.getBotDetectionConfigForUrl=t=>(o.default.get('botDetectionEndpoints')||[]).find(({endpoint:o})=>t.startsWith(o))||null},"46fe00",["ba7a76","ef2bc3"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.noop=function(){}},"48048d",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var c=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.getLocaleAndCurrencyQueryString=function(c){const l=u.default.current().curr;return{locale:c?.locale??t.default.locale(),...l?{currency:l}:{}}};var t=c(r(d[1])),u=c(r(d[2]))},"4c8a33",["ba7a76","862e50","06a99e"]);
__d(function(g,r,i,a,m,e,d){"use strict";function n(){const t=r(d[0]);return n=function(){return t},t}function t(){const n=r(d[1]);return t=function(){return n},n}function o(){const n=r(d[2]);return o=function(){return n},n}Object.defineProperty(e,"__esModule",{value:!0}),e.computeSubscriptionNormalizationIdentifiers=function(t){const{subscription:o,variables:c}=t,{normalizedItemsLocators:u}=o;return{subscriptionCacheKey:(0,n().computeOperationCacheKey)(o,c),normalizedItemsLocators:u}},e.identifyGraphQLTransform=function(t){const o=t.queryRef?.options,{operation:c,variables:u}=o||t,s=c.name,p=(0,n().computeOperationCacheKey)(c,u);return{...t,operationName:s,operationType:c.type,key:p}},e.identifyRESTTransform=function(n){const{fetchUrl:c,url:u,method:s,body:p}=n;return{...n,operationName:(0,o().normalizeRESTOperationName)(u),operationType:'query',key:(0,t().computeRESTOperationCacheKey)(c,s,p)}}},"5b3464",["34be0f","5bae5c","89642a"]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(){const n=r(d[0]);return t=function(){return n},n}function n(t){const[n,c]=t.split('?');if(!c)return n;const o=new URLSearchParams(c);return['currency','locale'].forEach(t=>o.delete(t)),o.size?`${n}?${o.toString()}`:n}Object.defineProperty(e,"__esModule",{value:!0}),e.computeRESTOperationCacheKey=function(c,o,u){return`${n(c)}:${o}:${JSON.stringify((0,t().convertToStableObjectOrder)(u))}`}},"5bae5c",["fad99e"]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.deliverNiobeBotDetection=function(){const t=(0,n.getTreatmentOverride)('niobe_bot_platform_force_in');if((0,o.default)(t))return t;return!0};var n=r(d[1]),o=t(r(d[2]))},"60f717",["ba7a76","f9341a","58861b"]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(){const n=r(d[0]);return t=function(){return n},n}function n(){const t=r(d[1]);return n=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.extractNormalizedItems=function(t,o){return t?o?.flatMap(o=>{const{itemsLocation:c,keyPath:s}=o;return(0,n().extractItemsWithLocators)({itemsLocation:c,result:t,keyPath:s}).filter(({key:t})=>t)}):void 0},e.watchNormalizedDependencies=function(n,o,c,s,u){let l,h=!1;const f=s?.map(({key:s,responsePath:p,value:P,keyPath:k})=>n.watchNormalizedItem(s,({data:s}={data:void 0})=>{l||(l=n.get(o)?.result||c),s&&(l={...l,data:(0,t().deepPatch)({responsePath:p,currentObject:l.data,newData:s,oldData:P,keyPath:k,insertNewField:!0})},h||(h=!0,Promise.resolve().then(()=>{f?.forEach(t=>t()),n.set(o,l,{normalizedItemsLocators:u,skipSetDependencies:!0})})))}))}},"668ebd",["99bed7","8866cf"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.subscriptionToOperationOptions=function(o){return{type:'graphql',operation:o.subscription,variables:{},fetchPolicy:'network-only',dedupePolicy:'no-dedupe',usePOSTForQuery:!1,context:{},skip:!1,deferrable:!1,headers:{},...o}}},"671ad8",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createNiobeHeaders=function(t){return{get:n=>t.get(n),has:n=>t.has(n),toJSON:()=>{}}}},"6e9310",[]);
__d(function(g,r,_i,_a,m,e,d){"use strict";function t(){const n=r(d[0]);return t=function(){return n},n}function n(){const t=r(d[1]);return n=function(){return t},t}function o(){const t=r(d[2]);return o=function(){return t},t}function s(){const t=r(d[3]);return s=function(){return t},t}function a(){const t=r(d[4]);return a=function(){return t},t}function c(t,n){if(t.length<n.length)return!1;for(let o=0;o<n.length;o++)if(t[o]!==n[o])return!1;return!0}Object.defineProperty(e,"__esModule",{value:!0}),e.catchErrorsInResponse=function(i,u,h){if(!i.data)return i;if(!u||!Array.isArray(u)||0===u.length)return i;const{error:f}=i;if(!n().NiobeError.isGraphQLErrors(f)||0===f?.cause?.length)return i;const l=f.cause??[],A=u.flatMap(({itemsLocation:t})=>(0,s().extractItemsWithLocators)({itemsLocation:t,result:i})),p=new Map;for(const t of A){const{responsePath:n}=t,o=n,s=n.join('.');if(p.set(s,{itemPathAddressArray:o}),'catch'===h&&'number'==typeof n[n.length-1]){const t=n.slice(0,-1),o=t.join('.');p.has(o)||p.set(o,{itemPathAddressArray:t})}}const y=Array.from(p.entries()).sort((t,n)=>n[1].itemPathAddressArray.length-t[1].itemPathAddressArray.length),P=new Map,b=[],E=[];for(const t of l){const n=t.path||[];let o=!1;for(const[s,{itemPathAddressArray:a}]of y)if(c(n,a)){const n=P.get(s);n?n.errors.push(t):P.set(s,{itemPathAddressArray:a,errors:[t]}),E.push(t),o=!0;break}o||b.push(t)}let w=i.data;for(const{itemPathAddressArray:s,errors:c}of P.values()){const u=(0,a().getValueAtPath)(i.data,s),h={[t().caughtGraphQLErrorsSymbol]:{data:u,error:new(n().NiobeError)(c)}};w=(0,o().deepPatch)({responsePath:s,currentObject:w,newData:h,insertNewField:!0})}const L='catch'===h?'catchErrors':'resultErrors';return{...i,data:w,error:b.length?new(n().NiobeError)(b):void 0,[L]:E.length?E:void 0}}},"74aeec",["db0b62","00dfad","99bed7","8866cf","83ee38"]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;function n(){const t=r(d[1]);return n=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.logRequestReplayEvent=function(t,{flagger:c,jitneyLogger:l,airlockId:u,viewName:_,fetchUrl:f,requestId:s}){if(!c.isTrebuchetLaunched((0,o.default)('web.niobe.airlock_replay_tracking')))return;let p;switch(t){case'waitForRequestReplay':p=9;break;case'requestReplayed':p=7;break;default:p=8}l({schema:n().AirlockHandlerActionEvent,event_data:{airlock_handler_action_type:p,airlock_metadata:{airlock_identifier:u??void 0,flow:_??void 0},platform:{device_type:3,platform_id:''},airlocked_api_endpoint:f,...s?{request_id:s}:{}}})};var o=t(r(d[2]))},"7a6dd3",["ba7a76","24396f","2c6bf9"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.logRetrierCancelled=function(n,l,c=null,t=null){const o={reason:l,view_name:t,is_legacy:c};n.increment('airlock.niobe.retrier.cancelled',1,o)}},"7ad8b2",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AGENT_FRICTION_HTTP_STATUS_CODE=void 0;e.AGENT_FRICTION_HTTP_STATUS_CODE=423},"7da3d6",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.deepMergeExceptArrays=function t(c,n){if(c&&n&&'object'==typeof c&&'object'==typeof n&&!Array.isArray(c)&&!Array.isArray(n))return Object.fromEntries([...Object.entries(c),...Object.entries(n).map(([n,o])=>[n,t(c[n],o)])]);return n}},"81e255",[]);
__d(function(g,r,_i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getValueAtPath=function(t,n){if(0===n.length)return t;if(null==t||'object'!=typeof t)return;let u=t;for(let t=0;t<n.length;t++){const f=n[t];if(null==u||'object'!=typeof u)return;if(Array.isArray(u)){if(!('number'==typeof f&&f>=0&&f<u.length))return;u=u[f]}else{if('string'!=typeof f||!(f in u))return;u=u[f]}}return u}},"83ee38",[]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(){const n=r(d[0]);return t=function(){return n},n}Object.defineProperty(e,"__esModule",{value:!0}),e.extractItemsWithLocators=function({itemsLocation:n,result:o,keyPath:u}){return n.reduce((o,s,c)=>{const{responseKey:y,typeCondition:p}=s;return o.flatMap(({value:o,responsePath:s})=>{if(!o)return[];if(!o.__typename||p.includes(o.__typename)){const p=o[y];return!p&&c<n.length-1?[]:Array.isArray(p)?p.map((n,o)=>({value:n,responsePath:[...s,y,o],...u&&{keyPath:u,key:(0,t().computeNormalizedCacheKey)(u,n)}})):[{value:p,responsePath:[...s,y],...u&&{keyPath:u},...u&&p&&{key:(0,t().computeNormalizedCacheKey)(u,p)}}]}return[]})},[{value:o.data,responsePath:[],...u&&{keyPath:u}}])}},"8866cf",["950b14"]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.NiobeClient=void 0;var n=r(d[1]),o=r(d[2]),s=r(d[3]);function c(){const t=r(d[4]);return c=function(){return t},t}function u(){const t=r(d[5]);return u=function(){return t},t}function h(){const t=r(d[6]);return h=function(){return t},t}function l(){const t=r(d[7]);return l=function(){return t},t}function f(){const t=r(d[8]);return f=function(){return t},t}function p(){const t=r(d[9]);return p=function(){return t},t}function y(){const t=r(d[10]);return y=function(){return t},t}function b(){const t=r(d[11]);return b=function(){return t},t}function R(){const t=r(d[12]);return R=function(){return t},t}function w(){const t=r(d[13]);return w=function(){return t},t}function v(){const t=r(d[14]);return v=function(){return t},t}function O(){const t=r(d[15]);return O=function(){return t},t}function S(){const t=r(d[16]);return S=function(){return t},t}function E(){const t=r(d[17]);return E=function(){return t},t}function I(){const t=r(d[18]);return I=function(){return t},t}function T(){const t=r(d[19]);return T=function(){return t},t}function k(){const t=r(d[20]);return k=function(){return t},t}function x(){const t=r(d[21]);return x=function(){return t},t}function C(){const n=t(r(d[22]));return C=function(){return n},n}function N(){const t=r(d[23]);return N=function(){return t},t}function A(){const t=r(d[24]);return A=function(){return t},t}function Q(){const t=r(d[25]);return Q=function(){return t},t}function L(){const t=r(d[26]);return L=function(){return t},t}function M(){const t=r(d[27]);return M=function(){return t},t}function P(){const n=t(r(d[28]));return P=function(){return n},n}function _(){const t=r(d[29]);return _=function(){return t},t}function D(){const t=r(d[30]);return D=function(){return t},t}function q(){const t=r(d[31]);return q=function(){return t},t}function z(){const t=r(d[32]);return z=function(){return t},t}function U(){const t=r(d[33]);return U=function(){return t},t}function $(){const t=r(d[34]);return $=function(){return t},t}function F(){const t=r(d[35]);return F=function(){return t},t}function G(){const t=r(d[36]);return G=function(){return t},t}let j=0;class H{constructor({hydrationData:t=[],fetch:s,generateRandomString:c,flagger:u,metricReporter:h,jitneyLogger:l,cacheMaxSize:p=f().DEFAULT_CACHE_MAX_SIZE,cache:y=new(f().NiobeCache)({hydrationData:t,maxSize:p,metricReporter:h}),inflight:b=new Map,retryOnNetworkError:R=!0,retryDelay:w,extraHeaders:v={},disablePrepare:S=!1,getRenderingState:E,apiGatewayURL:T,fetchStatusMessageTarget:k,webSocketClient:x,usePOSTForQueries:N=!1,isRuntimeResponseMockingEnabled:A=!0,synchronousResolver:Q,clearPersistentCache:L=C().default,origin:M}){this.type='minimalist',this.cache=void 0,this.inflight=void 0,this.flagger=void 0,this.metricReporter=void 0,this.jitneyLogger=void 0,this.fetch=void 0,this.generateRandomString=void 0,this.getRenderingState=void 0,this.retryOnNetworkError=void 0,this.retryDelay=void 0,this.retriers=[['recaptchaRetrier',I().recaptchaRetrier],['airlockRetrier',o.airlockRetrier],['agentFrictionRetrier',n.agentFrictionRetrier],['networkErrorRetrier',O().networkErrorRetrier]],this.extraHeaders=void 0,this.disablePrepare=void 0,this.apiGatewayURL=void 0,this.webSocketClient=void 0,this.usePOSTForQueries=void 0,this.transformedOptions=void 0,this.isRuntimeResponseMockingEnabled=void 0,this.synchronousResolver=void 0,this.clearPersistentCache=void 0,this.fetchStatusMessageTarget=void 0,this.webSocketMultiAbortController=void 0,this.webSocketSubscription=void 0,this.isDirectCacheAccessAllowed=!0,this.cache=y,this.inflight=b,this.retryOnNetworkError=R,this.retryDelay=w,this.getRenderingState=E,this.flagger=u,this.metricReporter=h,this.jitneyLogger=l,this.extraHeaders=v,this.disablePrepare=S,this.fetch=s,this.generateRandomString=c,this.apiGatewayURL=T||'',this.transformedOptions=new WeakMap,this.webSocketClient=x,this.usePOSTForQueries=N,this.isRuntimeResponseMockingEnabled=A,this.synchronousResolver=Q,this.clearPersistentCache=L,this.fetchStatusMessageTarget=k,this.metricReporter.increment('frontend_niobe_initialized',1,{origin:M,...M.startsWith('hyperloop-')?{numClientsCreatedViaHyperloop:++j}:{}})}preloadQuery(t){const n=(0,U().queryToOperationOptions)(t);return this.execute(n)}preloadRestQuery(t){return this.execute((0,M().getOptionsToRESTOptions)(t))}prefetchPreloadQuery(t){const n=(0,U().queryToOperationOptions)(t);return this.execute({...n,context:{type:'prefetch',...n.context,headers:{'x-airbnb-prefetch':'true',...n.context.headers},fetchOptions:{...n.context.fetchOptions,type:'prefetch'}}})}async query(t){const n=(0,U().queryToOperationOptions)(t),o=await this.execute(n).promise;if(t.unsafe__shouldThrowErrors&&o.error?.networkError)throw o.error.networkError;return o}async prefetchQuery(t){return this.prefetchPreloadQuery(t).promise}readQuery(t){return this.readResult((0,U().queryToOperationOptions)(t))?.data??null}writeQuery(t){const n=this.transformOptions((0,U().queryToOperationOptions)(t)),o={data:t.data},s=h().NiobeQueryRef.for({options:(0,U().queryToOperationOptions)(t),promise:Promise.resolve(o),result:o,clientType:this}),{promise:c}=s;this.processResult({transformedOptions:n,result:o,promise:c,source:'manual'})}unsafe__writeQuery(t){if(!this.isDirectCacheAccessAllowed){const n=t.query.name;(0,u().warnNiobeError)((0,u().directCacheAccessDuringOptimisticUpdateError)(n))}this.writeQuery(t)}readItem({typename:t,keyField:n,id:o,excludeOptimisticData:s=!1}){const c=`${t}.${n}:${o}`,u=this.cache.getNormalizedItem(c);if(!u)return null;const h=s?u?.result:u?.resultWithOptimisticData;return h?.data??null}writeItem({typename:t,keyField:n,id:o,data:s,unsafe__overwriteData:c}){const u=`${t}.${n}:${o}`;this.cache.setNormalizedItem(u,{data:s},{unsafe__overwriteData:c})}unsafe__readItem(t){return this.readItem({...t,excludeOptimisticData:!1})}unsafe__writeItem(t){this.isDirectCacheAccessAllowed||(0,u().warnNiobeError)((0,u().directCacheAccessDuringOptimisticUpdateError)(t.typename)),this.writeItem(t)}handleOptimisticResponse({optimisticResponse:t,update:n,mutation:o,variables:s}){if(!t)return q().noop;const c={data:t},h=(0,N().computeOperationCacheKey)(o,s),{normalizedItemsLocators:l}=o;if(!n){const t=(0,S().extractNormalizedItems)(c,l);if(!t?.length)return(0,u().warnNiobeError)((0,u().optimisticResponseWithoutNormalizedItemsError)(o.name)),q().noop}const p=[],y=(0,f().cacheOptimisticResult)(this.cache,{cacheKey:h,variables:s,normalizedItemsLocators:l,result:c});if(p.push(y),n){const t={readItem:this.readItem.bind(this),readQuery:this.readQuery.bind(this),writeItem:t=>{const n=(0,f().cacheOptimisticItem)(this.cache,t);p.push(n)},writeQuery:({query:t,variables:n,data:o})=>{const s=(0,N().computeOperationCacheKey)(t,n),{normalizedItemsLocators:c}=t,u=(0,f().cacheOptimisticResult)(this.cache,{cacheKey:s,variables:n,normalizedItemsLocators:c,result:{data:o}});p.push(u)}};this.isDirectCacheAccessAllowed=!1,n(t,c),this.isDirectCacheAccessAllowed=!0}return()=>p.forEach(t=>t())}async mutate(t){const n=this.handleOptimisticResponse(t),o=(0,D().mutationToOperationOptions)(t),s=await this.execute(o).promise;if(s.error&&t.unsafe__shouldThrowErrors){const t=(0,z().parseMutationErrorToThrow)(s.error);if(t)throw n(),t}if(!s.error&&t.update){const n={readItem:t=>this.readItem({...t,excludeOptimisticData:!0}),readQuery:t=>{const n=(0,U().queryToOperationOptions)(t);return this.readResult({...n,excludeOptimisticData:!0})?.data??null},writeItem:this.writeItem.bind(this),writeQuery:this.writeQuery.bind(this)};t.update(n,s)}return n(),s}createWebSocketSubscription(t){const{webSocketClient:n}=this;if(!n)throw new Error('no websocket client');if(this.webSocketSubscription&&!this.webSocketMultiAbortController?.aborted)return this.webSocketMultiAbortController?.addSignal(t),this.webSocketSubscription;this.webSocketMultiAbortController=new(w().MultiAbortController)({waitTick:!0}),this.webSocketMultiAbortController.addSignal(t);const o=n.subscribe('graphql_subscription',this.webSocketMultiAbortController.signal),s=t=>{'disconnected'!==t.state?(this.webSocketSubscription=t,t.next?.then(s)):this.webSocketSubscription=void 0};return s(o),o}async initiateGraphQLSubscription(t,n){const o=await this.execute((0,F().subscriptionToOperationOptions)({...t,context:{...t.context,headers:{...t.context?.headers,'x-airbnb-websocket-connection-id':n}}})).promise,s=o.extensions?.subscription?.subscriptionId;return s||((0,u().reportNiobeError)((0,u().missingSubscriptionId)(t.subscription.name)),(0,u().throwNiobeError)((0,u().missingSubscriptionId)(t.subscription.name))),{subscriptionId:s,result:o,error:void 0}}async*subscribe(t){const{signal:n,delay:o}=t;if(o&&await new Promise(t=>{setTimeout(t,o)}),n.aborted)return;let s=this.createWebSocketSubscription(n);for(yield{state:'pending'};'pending'===s.state||'reconnecting'===s.state;)s=await s.next;if('disconnected'===s.state){const{sourceError:t}=s,{wasClean:n,code:o,reason:c}=t;return void(n?yield{state:'disconnected'}:yield{state:'error',error:new Error(`${o} - ${c}`)})}const{connection:c}=s,h=this.initiateGraphQLSubscription(t,c.connectionId),{result:l,subscriptionId:p,error:y}=await h.catch(t=>({subscriptionId:void 0,result:void 0,error:t}));if(void 0===p)return void(yield{state:'error',error:y});yield{state:'established'},l?.data&&(yield{state:'message',data:l});const R=()=>this.unsubscribe(p);function w(t){return t.extensions?.subscription?.subscriptionId===p}for(n.addEventListener('abort',R,{once:!0}),s=await s.next;s;){if('established'===s.state)yield{state:'established'};else if('reconnecting'===s.state)yield{state:'reconnecting'};else if('disconnected'===s.state){const{sourceError:t}=s,{wasClean:n,code:o,reason:c}=t;if(n)yield{state:'disconnected'};else{const t=new Error(`${o} - ${c}`);yield{state:'error',error:t}}}else if('message'===s.state){const{message:n}=s;try{const o=JSON.parse(n);if(w(o)){const{subscriptionCacheKey:n,normalizedItemsLocators:s}=(0,b().computeSubscriptionNormalizationIdentifiers)(t);(0,f().cacheResult)(this.cache,{key:n,result:o,normalizedItemsLocators:s}),yield{state:'message',data:o}}}catch{(0,u().warnNiobeError)((0,u().unparseableSubscriptionMessage)(n))}}s=await s.next}s||n.aborted||(R(),yield{state:'resubscribing'},yield*this.subscribe({...t,delay:Math.min(3e4,o?2*o:100)}))}async unsubscribe(t){this.mutate({mutation:x().UnsubscribeMutationOperation,variables:{subscriptionId:t}})}extract(){return this.cache.serialize()}invalidate({query:t,variables:n}){const{cache:o}=this,s=t.name,c=n?(0,N().computeOperationCacheKey)(t,n):s;o.invalidate({keyPrefix:c});const{operationId:u}=t;if((0,P().default)(s,this.flagger)&&u){const t=`${(0,Q().getHostAndPath)(this.apiGatewayURL)}/${s}/${u}`,o=(0,_().mergeURLSearchParams)({operationName:s,...(0,L().getLocaleAndCurrencyQueryString)(),...n?{variables:JSON.stringify(n)}:{},extensions:JSON.stringify({persistedQuery:{version:E().OPERATION_REGISTRY_VERSION,sha256Hash:u}})}),c=(0,A().formatUrl)(t,o);this.clearPersistentCache?.(c)}}updateCache(t){t.forEach(([t,{normalizedItemsLocators:n,...o}])=>{(0,f().cacheResult)(this.cache,{key:t,result:o,normalizedItemsLocators:n})})}readResult(t){if('queryRef'in t){const{queryRef:n}=t;n.clientType&&n.clientType!==this&&(0,u().throwNiobeError)((0,u().receivedQueryRefForWrongClient)(this,n.clientType));const o=this.transformOptions(n.options),[,s]=this.syncResolve(o)||[];return s??n.result??void 0}const n=this.transformOptions(t),[,o]=this.syncResolve(n)||[];return o}watchOnce(t,n){const{options:o}=t;return o.skip?q().noop:this.cache.watch(this.transformOptions(o).key,t=>{const s=t?h().NiobeQueryRef.for({promise:Promise.resolve(t),result:t,clientType:this,options:o,deferred:t.deferred}):this.execute(o);n(s)})}executeFrom({queryRef:t,options:n}){const{options:o}=t;return this.execute({...o,...n,variables:{...o.variables,...n.variables}})}transformOptions(t){const{metricReporter:n,metricReporter:{now:o},extraHeaders:s,apiGatewayURL:c,generateRandomString:u,usePOSTForQueries:h,flagger:f}=this;const y=this.transformedOptions.get(t);if(y)return y;const R=(function(){if('rest'===t.type){const c=(0,k().timeoutSignalTransform)((0,l().abortSignalTransform)((0,v().metricsTransform)(t,o,u))),h=(0,p().contextRESTTransform)({options:c,extraHeaders:s,metricReporter:n,flagger:f});return(0,b().identifyRESTTransform)(h)}const y=(0,k().timeoutSignalTransform)((0,l().abortSignalTransform)((0,v().metricsTransform)(t,o,u))),R=(0,b().identifyGraphQLTransform)(y),w=(0,E().operationRegistryTransform)(R,h);return(0,p().contextGraphqlTransform)({options:w,extraHeaders:s,metricReporter:n,apiGatewayURL:c,flagger:f})})();return this.transformedOptions.set(t,R),R}syncResolve(t){const n=(0,T().skipResolver)(t);if(n)return['skip',n];const{cache:o}=this,s=(0,f().cacheResolver)(o,t,this.getRenderingState);if(s){return[s.fromPrefetch?'cache-prefetch':'cache',s.result]}const c=this.synchronousResolver?.(t);return c?['injected-sync-resolve',c]:'cache-only'===t.fetchPolicy?['cache-only-miss',{data:void 0}]:void 0}asyncResolve(t,n){const{inflight:o,cache:s,fetch:u,flagger:h,metricReporter:l,jitneyLogger:p,generateRandomString:b,fetchStatusMessageTarget:w,isRuntimeResponseMockingEnabled:O}=this,S=[],E=b(),I=async t=>{const o=b(),s=await(0,y().httpResolver)({metricReporter:l,fetch:u,fetchStatusMessageTarget:w,clientRequestId:o,options:t,isRuntimeResponseMockingEnabled:O,flagger:h});return S.push(o),(0,v().reportAPIResponseMetrics)({flagger:h,jitneyLogger:p,apiEventAttemptId:o,result:s,options:t,apiRequestId:E}),s.metrics&&(s.metrics.requestEventIds=S),c().NiobeError.isAbortError(s.error)||(0,$().redirectOnKrakenAuthenticationError)(s)?s:this.maybeRetry(n,t,s,I)},T=(0,R().inflightQueryResolver)(o,t)?.then(n=>c().NiobeError.isAbortError(n.error)&&!t.multiAbortController.aborted?I(t):n);if(T)return['network-dedupe',T];const k=(0,f().cacheDeferredResolver)(s,t);return k?['cache-deferred',k]:['network',I(t)]}async maybeRetry(t,n,o,s){const c=3+(0,O().getTotalNetworkErrorRetrierAttempts)(),u=n.context?.attemptsCount??2;if(u>=c)return o;const h=this.getRetrier(o,n);if(!h)return o;const l=await h.context;if(!l)return o;return s(this.transformOptions({...t,dedupePolicy:'no-dedupe',context:{...t.context,...l,attemptsCount:u+1,clientTraceId:n.context.clientTraceId}}))}getRetrier(t,n){const o={niobeClient:this,result:t,options:n,retryOnNetworkError:this.retryOnNetworkError,retryDelay:this.retryDelay,flagger:this.flagger,metricReporter:this.metricReporter,jitneyLogger:this.jitneyLogger};let s;for(const[t,n]of this.retriers)if(s=s??n(o),s)return this.metricReporter.increment('niobe.retriers.retry_signaled',1,{retrier:t}),s}processResult({transformedOptions:t,result:n,promise:o,source:c}){const{cache:u,inflight:h,metricReporter:l,jitneyLogger:p,getRenderingState:y}=this;if('skip'===c)return;const b=[n=>(0,R().storeInflightQuery)(h,t,n),()=>(0,f().cacheDeferredSentinel)(u,t,y)];b.forEach(t=>t(o));const w='graphql'===t.type?t.operation.normalizedItemsLocators:[],O=[n=>{'cache'!==c&&'cache-only-miss'!==c&&(0,f().cacheResult)(u,{...t,result:n,normalizedItemsLocators:w})},()=>(0,R().clearInflightQuery)(h,t),n=>{n?.error&&(0,P().default)(t.operationName,this.flagger)&&this.clearPersistentCache?.(t.fetchUrl)},n=>{const o=l.now();(0,v().reportCacheMetrics)(p,t,n,c,o)},t=>{if(t.extensions?.traceId){const n=t.error?'error':'success';(0,s.saveTraceId)(t.extensions?.traceId,n)}}];n?O.forEach(t=>t(n)):o.then(t=>O.forEach(n=>n(t)))}execute(t){if('queryRef'in t)return t.queryRef;const n=this.transformOptions(t),[o,s]=(()=>{const o='deferrable'in t&&t.deferrable,s=this.syncResolve(n);if(s){const[n,c]=s;return[n,h().NiobeQueryRef.for({promise:Promise.resolve(c),result:c,clientType:this,options:t,deferred:o})]}const[c,u]=this.asyncResolve(n,t),l=u.then(t=>(0,G().transformResponse)(t,n.operation));return[c,h().NiobeQueryRef.for({promise:l,clientType:this,options:t,deferred:o})]})();return this.processResult({transformedOptions:n,result:s.result||void 0,promise:s.promise,source:o}),s}}e.NiobeClient=H;e.default=H},"8889e8",["ba7a76","2f7cf3","a145d5","f2f40f","00dfad","07f19c","ee1cae","41c843","8f864f","abc507","f9267b","5b3464","459e51","b3b435","b80b94","b7fb26","668ebd","c0fdc0","f5568d","0c3d76","096956","ceadbe","e15052","34be0f","45f45a","f8aa06","4c8a33","a0a6de","d8c0f0","ab4631","91eae7","48048d","f9de9f","043517","bf6bc6","671ad8","c948ba"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.normalizeRESTOperationName=function(t){return t.split('?')[0].replace(/\/{2,}/g,'/').replace(/(^\/?([^/]+\/){3}).*/g,'$1').replace(/\/$/,'')}},"89642a",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.redirectToUrl=function(t){window.location.href=t};t(r(d[1]))},"8bd668",["ba7a76","cfeceb"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(u){if(u.response?.status===t.AGENT_FRICTION_HTTP_STATUS_CODE){const t=u.error?.networkError?.result,c=u.error?.networkError?.body;if(n(t)&&c)return{...t,frictionId:o(c,t.frictionId)}}return null};var t=r(d[0]);function n(t){const n=t?.frictionId;return Boolean(n)||0===n}function o(t,n){if('string'==typeof n)return n;const o=t.match(/"frictionId":\s*(\d+)/);return o?.[1]||String(n)}},"8be4f5",["7da3d6"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.extractViewName=function(t,n){let l=null;if(!t)return l;if('v1'===n)l=t.friction_data?.at(0)?.name||null;else if('v2'===n){const{viewPayload:n}=t;if(!n)return l;l='AirlockFlowViewPayload'===n?.__typename?n.flowView:n.frictionView}return l}},"8cd0d8",[]);
__d(function(g,r,i,a,m,e,d){'use strict';Object.defineProperty(e,"__esModule",{value:!0});e.ApiOperationType={query:1,mutation:2,subscription:3}},"8da96c",[]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(){const s=r(d[0]);return t=function(){return s},s}function s(){const t=r(d[1]);return s=function(){return t},t}function o(){const t=r(d[2]);return o=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.NiobeCache=e.DEFAULT_CACHE_MAX_SIZE=void 0,e.cacheDeferredResolver=function(t,{key:s,deferrable:o,fetchPolicy:c,excludeOptimisticData:h}){if(!o)return;if('network-only'===c||'no-cache'===c||'cache-and-network'===c)return;const n=t.get(s),l=h?n?.result:n?.resultWithOptimisticData;if(!l)return;if(!l.deferred)return Promise.resolve(l);return new Promise(o=>{t.watch(s,t=>{t&&o(t)})})},e.cacheDeferredSentinel=function(t,{key:s,deferrable:o},c){o&&'server-render'===c()&&t.set(s,{data:void 0,deferred:!0})},e.cacheOptimisticItem=function(t,{typename:s,keyField:o,id:c,data:h}){const n=`${s}.${o}:${c}`,l=Symbol(`optimistic-${n}`);return t.setNormalizedItem(n,{data:h},{optimisticCacheKey:l}),()=>{t.setNormalizedItem(n,void 0,{optimisticCacheKey:l})}},e.cacheOptimisticResult=function(t,{cacheKey:o,variables:c,normalizedItemsLocators:h,result:n}){const l=(0,s().extractNormalizedItems)(n,h),u=Symbol(`optimistic-${o}`);return t.set(o,n,{normalizedItemsLocators:h,optimisticCacheKey:u,variables:c}),()=>{if(t.set(o,void 0,{optimisticCacheKey:u,variables:c}),l?.length){const s=l.map(t=>({...t,value:void 0}));t.setDependencies(s,{optimisticCacheKey:u})}}},e.cacheResolver=function(t,{key:s,fetchPolicy:o,maxAge:c,queryRef:h,excludeOptimisticData:n},l){if(h){const{result:t}=h;return t&&!t.deferred?{result:t,fromPrefetch:!1}:void 0}if('network-only'===o||'no-cache'===o)return;if('cache-and-network'===o&&'client-hydration'!==l())return;const u=t.get(s,{maxAge:c}),f=n?u?.result:u?.resultWithOptimisticData;if(!f||f?.deferred)return;return{result:f,fromPrefetch:Boolean(u?.fromPrefetch)}},e.cacheResult=function(s,{key:o,result:c,fetchPolicy:h,normalizedItemsLocators:n,variables:l,context:{type:u}={}}){if('no-cache'===h)return;if(c.deferred)return;if(c.error&&!s.get(o)?.result?.deferred)return;if(c.error&&t().NiobeError.isSSRTimeoutError(c.error))return;if(c.catchErrors?.length||c.resultErrors?.length)return;s.set(o,c,{fromPrefetch:'prefetch'===u,normalizedItemsLocators:n,variables:l})};const c=e.DEFAULT_CACHE_MAX_SIZE=268435456,h=null;class n{constructor(t){this.key=void 0,this.size=void 0,this.result=void 0,this.resultWithOptimisticData=void 0,this.variables=void 0,this.normalizedItemsLocators=void 0,this.optimisticData=void 0,this.createdAt=void 0,this.fromPrefetch=void 0,this.watchers=void 0,this.key=t,this.watchers=[],this.size=0,this.fromPrefetch=!1}setResult(t,{fromPrefetch:s=!1,optimisticCacheKey:c,now:h}){const n=this.resultWithOptimisticData;if(c?this.setOptimisticResult(c,t):(this.result=t,this.fromPrefetch=s),this.optimisticData?.size){const t=[...this.optimisticData.values()].reduce((t,s)=>s?(0,o().deepMergeExceptArrays)(t,s):t,this.result?.data);this.resultWithOptimisticData={...this.result,data:t}}else this.resultWithOptimisticData=this.result;const l=void 0===t,u=JSON.stringify(this.resultWithOptimisticData?.data),f=u!==JSON.stringify(n?.data);this.size=this.resultWithOptimisticData?.data?u.length:0,this.createdAt=h(),(f||l)&&this.notify()}setOptimisticResult(t,s){if(!s)return this.optimisticData?.delete(t),void(0===this.optimisticData?.size&&(this.optimisticData=void 0));this.optimisticData||(this.optimisticData=new Map),this.optimisticData.set(t,s?.data)}setNormalizedItemsLocators(t){this.normalizedItemsLocators=t}setVariables(t){this.variables=t}isCollectable(){return 0===this.watchers.length}watch(t){const s=this;return s.watchers=s.watchers.concat(t),function(){s.watchers=s.watchers.filter(s=>s!==t)}}notify(){const{watchers:t,resultWithOptimisticData:s}=this;this.watchers=[],t.forEach(t=>t(s))}}e.NiobeCache=class{constructor({hydrationData:t,metricReporter:s,maxSize:o=c}){this.data=void 0,this.normalizedItems=void 0,this.size=void 0,this.maxSize=void 0,this.lastTouchedEntry=void 0,this.metricReporter=void 0,this.data=new Map,this.normalizedItems=new Map,this.size=0,this.maxSize=o,this.metricReporter=s,t.forEach(([t,{normalizedItemsLocators:s,variables:o,...c}])=>{this.set(t,c,{normalizedItemsLocators:s,variables:o})})}serialize(){return Array.from(this.data.entries()).reduce((t,[s,o])=>{if(o!==h&&void 0!==o.result){const{variables:c,normalizedItemsLocators:h,result:n}=o,{data:l,error:u,deferred:f}=n;t.push([s,{data:l,error:u,deferred:f,variables:c,normalizedItemsLocators:h}])}return t},[])}get(t,{maxAge:s}={}){const o=this.data.get(t);if(o===h&&this.metricReporter.increment('frontend.niobe.mini_cache_miss',1,{}),!o)return;const{createdAt:c}=o;return c&&s&&this.metricReporter.now()-1e3*s>c?void 0:(this.touch(o),o)}getNormalizedItem(t){const s=this.normalizedItems.get(t);if(s===h&&this.metricReporter.increment('frontend.niobe.mini_cache_miss',1,{}),s)return this.touchNormalizedItem(s),s}set(t,o,{fromPrefetch:c=!1,normalizedItemsLocators:h,variables:l,skipSetDependencies:u,optimisticCacheKey:f}={}){const p=this.data.get(t),z=p??new n(t);z.setVariables(l),h&&z.setNormalizedItemsLocators(h),z.setResult(o,{fromPrefetch:c,optimisticCacheKey:f,now:this.metricReporter.now});const y=(0,s().extractNormalizedItems)(o,h);y&&(u||this.setDependencies(y,{optimisticCacheKey:f}),o&&!f&&(0,s().watchNormalizedDependencies)(this,t,o,y,h)),this.touch(z),this.size+=z.size-(p?.size??0),this.prune()}setDependencies(t,{optimisticCacheKey:s}={}){t?.forEach(({key:t,value:o})=>{this.setNormalizedItem(t,{data:o},{optimisticCacheKey:s})})}setNormalizedItem(t,s,{optimisticCacheKey:c,unsafe__overwriteData:h}={}){const l=this.normalizedItems.get(t),u=l??new n(t);if(c)u.setResult(s,{optimisticCacheKey:c,now:this.metricReporter.now});else if(h)u.setResult(s,{now:this.metricReporter.now});else{const t=(0,o().deepMergeExceptArrays)(l?.result?.data,s?.data);u.setResult({...s,data:t},{now:this.metricReporter.now})}this.touchNormalizedItem(u),this.size+=u.size-(l?.size??0),this.prune()}watch(t,s){const{data:o}=this,c=o.get(t)??new n(t);return o.set(t,c),c.watch(s)}watchNormalizedItem(t,s){const{normalizedItems:o}=this,c=o.get(t)??new n(t);return o.set(t,c),c.watch(s)}invalidate({keyPrefix:t}){[...this.data.keys()].filter(s=>s.startsWith(t)).forEach(t=>{this.set(t,void 0)})}clear(){this.data.clear(),this.normalizedItems.clear(),this.size=0,this.lastTouchedEntry=void 0}delete(t){const s=this.data.get(t);s&&(this.data.set(t,h),this.size-=s.size)}deleteNormalizedItem(t){const s=this.normalizedItems.get(t);s&&(this.normalizedItems.set(t,h),this.size-=s.size)}touch(t){t!==this.lastTouchedEntry&&(this.lastTouchedEntry=t,this.data.delete(t.key),this.data.set(t.key,t))}touchNormalizedItem(t){t!==this.lastTouchedEntry&&(this.lastTouchedEntry=t,this.normalizedItems.delete(t.key),this.normalizedItems.set(t.key,t))}prune(){if(!(this.size<=this.maxSize)){for(const[t,s]of this.normalizedItems){if(this.size<=this.maxSize)return;s!==h&&s.isCollectable()&&this.deleteNormalizedItem(t)}for(const[t,s]of this.data){if(this.size<=this.maxSize)return;s!==h&&s.isCollectable()&&this.delete(t)}}}}},"8f864f",["00dfad","668ebd","81e255"]);
__d(function(g,r,i,a,_m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.maybeGetRecaptchaV3TokenHeader=void 0;var o=t(r(d[1])),n=r(d[2]),s=r(d[3]),c=r(d[4]);const u=()=>{};e.maybeGetRecaptchaV3TokenHeader=(t,l,p,h=!1)=>{const m=(0,s.getBotDetectionConfigForUrl)(t);if(null===m)return u;if(!m.methods.map(t=>t.toUpperCase()).includes(l.toUpperCase()))return u;if(o.default.getBootstrap('trust_ai_disable_recaptchav3'))return u;if(h)return u;const f={action:m.actionName||(0,n.getNotSetEndpointActionName)(m.endpoint?.slice(1)),...m.timeout&&{timeoutInMs:m.timeout},...m.shouldThrow&&{shouldThrow:m.shouldThrow},...m.retries&&{maxRetries:m.retries},isPlatformized:p};return()=>(0,c.getRecaptchaV3TokenHeader)(f)}},"913737",["ba7a76","c235f8","336c95","46fe00","fa27ff"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mutationToOperationOptions=function(o){return{type:'graphql',operation:o.mutation,variables:void 0,fetchPolicy:'network-only',dedupePolicy:'no-dedupe',usePOSTForQuery:!1,context:{},skip:!1,deferrable:!1,headers:{},...o}}},"91eae7",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.AirlockNiobeLogger=void 0;var l=t(r(d[1])),o=t(r(d[2]));function n(){const t=r(d[3]);return n=function(){return t},t}function c(){const t=r(d[4]);return c=function(){return t},t}var s=t(r(d[5])),v=(0,o.default)("jitneyLogger"),f=(0,o.default)("metricReporter"),u=(0,o.default)("flagger");e.AirlockNiobeLogger=class{get shouldTrackAirlockReplay(){return(0,l.default)(this,u)[u].isTrebuchetLaunched((0,s.default)('web.niobe.airlock_replay_tracking'))}constructor({jitneyLogger:t,metricReporter:o,flagger:n}){Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,f,{writable:!0,value:void 0}),Object.defineProperty(this,u,{writable:!0,value:void 0}),(0,l.default)(this,v)[v]=t,(0,l.default)(this,f)[f]=o,(0,l.default)(this,u)[u]=n}logRetrierCancelled({viewName:t,platformVersion:l},o){const n={reason:o,view_name:t,is_legacy:'none'===l?null:'v1'===l};this.increment('airlock.niobe.retrier.cancelled',1,n)}logReceived({airlockId:t,platformVersion:l,viewName:o},n){this.logJitneyEvent({schema:c().AirlockPlatformAirlockLifecycleEvent,event_data:{event_type:3,event_data:{airlock_id:t||''},lifecycle_event_meta:{platform_version:l}}}),this.logHandlerActionEvent({airlockId:t,viewName:o,platformVersion:l},1,n)}logFullPageRedirect({airlockId:t,platformVersion:l,viewName:o}){this.logRetrierCancelled({platformVersion:l,viewName:o},'fullpageRedirect'),this.logJitneyEvent({schema:c().AirlockPlatformAirlockLifecycleEvent,event_data:{event_type:4,event_data:{airlock_id:t||''},lifecycle_event_meta:{platform_version:l}}})}logRetryCount({platformVersion:t,viewName:l},o){const n={view_name:l,is_legacy:'none'===t?null:'v1'===t},c=o?'airlock.niobe.retrier.success':'airlock.niobe.retrier.failure';this.increment(c,1,n)}logRequestReplayed({airlockId:t,platformVersion:l,viewName:o},n){this.logJitneyEvent({schema:c().AirlockPlatformAirlockLifecycleEvent,event_data:{event_type:18,event_data:{airlock_id:t||''},lifecycle_event_meta:{platform_version:l}}}),this.shouldTrackAirlockReplay&&this.logHandlerActionEvent({airlockId:t,viewName:o,platformVersion:l},9,n)}logRequestNotReplayed(t,l){this.shouldTrackAirlockReplay&&this.logHandlerActionEvent(t,8,l)}logRequestReplayCompleted(t,l,o){this.shouldTrackAirlockReplay&&this.logHandlerActionEvent(t,7,l,o)}logJitneyEvent(t){(0,l.default)(this,v)[v](t)}increment(t,o,n){(0,l.default)(this,f)[f].increment(t,o,n)}logHandlerActionEvent({airlockId:t,viewName:l},o,c,s){this.logJitneyEvent({schema:n().AirlockHandlerActionEvent,event_data:{airlock_handler_action_type:o,airlock_metadata:{airlock_identifier:t||void 0,flow:l||void 0},platform:{device_type:3,platform_id:''},airlocked_api_endpoint:c,...s?{request_id:s}:{}}})}}},"924b00",["ba7a76","76718e","99527b","24396f","a4ed0f","2c6bf9"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"logAirlockLifecycleEvent",{enumerable:!0,get:function(){return t.logAirlockLifecycleEvent}}),Object.defineProperty(e,"logRequestReplayEvent",{enumerable:!0,get:function(){return n.logRequestReplayEvent}}),Object.defineProperty(e,"logRetrierCancelled",{enumerable:!0,get:function(){return l.logRetrierCancelled}}),Object.defineProperty(e,"logRetryCount",{enumerable:!0,get:function(){return o.logRetryCount}});var t=r(d[0]),n=r(d[1]),l=r(d[2]),o=r(d[3])},"94a171",["0876d7","7a6dd3","7ad8b2","9f19fd"]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(){const n=r(d[0]);return t=function(){return n},n}Object.defineProperty(e,"__esModule",{value:!0}),e.computeNormalizedCacheKey=function(n,u){const c=(0,t().getKeyPathValue)(n,u);return c?`${u.__typename}.${n}:${c}`:''}},"950b14",["1e477a"]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(){const n=r(d[0]);return t=function(){return n},n}function n(){const t=r(d[1]);return n=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.deepPatch=function o({responsePath:c,currentObject:u,newData:s,oldData:l,keyPath:f,insertNewField:h}){if(0===c.length){if(f){if((0,n().getKeyPathValue)(f,u)!==(0,n().getKeyPathValue)(f,s))return u}return s}const[y,...P]=c;if('number'==typeof y)return Array.isArray(u)?!u[y]&&l?u:[...u.slice(0,y),o({responsePath:P,currentObject:u[y],newData:s,oldData:l,keyPath:f,insertNewField:h}),...u.slice(y+1)]:((0,t().warnNiobeError)((0,t().invalidNormalizationPatch)()),u);if('string'==typeof y)return'object'!=typeof u||!u||Array.isArray(u)?((0,t().warnNiobeError)((0,t().invalidNormalizationPatch)()),u):u[y]||h?{...u,[y]:o({responsePath:P,currentObject:u[y],newData:s,oldData:l,keyPath:f,insertNewField:h})}:u;(0,t().warnNiobeError)((0,t().invalidNormalizationPatch)())}},"99bed7",["07f19c","1e477a"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.logRetryCount=function(n,t,c,o){const s={view_name:o,is_legacy:c};t?n.increment('airlock.niobe.retrier.success',1,s):n.increment('airlock.niobe.retrier.failure',1,s)}},"9f19fd",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.redirectToAirlockIfFullpage=function(l,n){if(!o(l))return!1;const{airlock:c,airlockId:u,platformVersion:f}=l;if(!c||!u)return!1;n.logFullPageRedirect(l);const s='v1'===f?`/airlock?al_id=${u}`:`/airlock/${u}`;return(0,t.redirectToUrl)(s),!0};var t=r(d[0]);function o({airlock:t,platformVersion:o}){if(!t)return!1;if('v1'===o){const o=t.friction_data?.at(0)?.style;return!!o&&['fullpage','forced_fullpage'].includes(o)}return'FULLPAGE'===t.airlockConfiguration?.webStyle}},"9f2c9e",["8bd668"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getOptionsToRESTOptions=function(t){return{type:'rest',body:void 0,context:{},deferrable:!1,fetchPolicy:'cache-first',dedupePolicy:'GET'===t.method||void 0===t.method?'dedupe-inflight':'no-dedupe',headers:{},method:'GET',skip:!1,...t}}},"a0a6de",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AIRLOCK_REPLAY_HEADER",{enumerable:!0,get:function(){return u.AIRLOCK_REPLAY_HEADER}}),e.airlockRetrier=void 0,Object.defineProperty(e,"buildAirlockPermitV2Header",{enumerable:!0,get:function(){return c.buildAirlockPermitV2Header}}),Object.defineProperty(e,"logRequestReplayEvent",{enumerable:!0,get:function(){return f.logRequestReplayEvent}});var l=t(r(d[1])),n=r(d[2]),o=r(d[3]),u=r(d[4]),c=r(d[5]),f=r(d[6]);e.airlockRetrier=({flagger:t,...u})=>!t.isTrebuchetLaunched((0,l.default)('airlock_platform_new_airlock_retrier'))?(0,o.airlockRetrier)({flagger:t,...u}):(0,n.airlockRetrier)({flagger:t,...u})},"a145d5",["ba7a76","2c6bf9","24eb52","dff2e4","f3d6f1","e41eda","94a171"]);
__d(function(g,r,i,a,m,e,d){'use strict';Object.defineProperty(e,"__esModule",{value:!0});var l=e.AirlockPlatformAirlockLifecycleEvent={defaultProps:{schema:'com.airbnb.jitney.event.logging.AirlockPlatform:AirlockPlatformAirlockLifecycleEvent:2.0.0',event_name:'airlockplatform_airlock_lifecycle'},propTypes:{}};l.fullyQualifiedName='AirlockPlatform.v2.AirlockPlatformAirlockLifecycleEvent';e.AirlockPlatformAirlockLifecycleEventEvent=function(c){return{eventData:c,eventDataSchema:l}}},"a4ed0f",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.createTimeoutSignal=function(t){if(void 0===t||t<=0)return;if(n=AbortSignal,'timeout'in n)return AbortSignal.timeout(t);var n;const o=new AbortController;return setTimeout(()=>o.abort('undefined'!=typeof DOMException?new DOMException('signal timed out','TimeoutError'):'signal timed out'),t),o.signal};t(r(d[1]))},"a9e08c",["ba7a76","58861b"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mergeURLSearchParams=function(...n){const t=n.filter(Boolean);return t.length?1===t.length?new URLSearchParams(t[0]):new URLSearchParams(t.flatMap(n=>n instanceof URLSearchParams?[...n.entries()]:Array.isArray(n)?n:[...new URLSearchParams(n).entries()])):void 0}},"ab4631",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.contextGraphqlTransform=function({options:t,extraHeaders:n,metricReporter:c,apiGatewayURL:s,flagger:h}){const{context:l,operationName:p,operation:R,fetchPolicy:A}=t,x=`${(0,y().getHostAndPath)(s)}/${p}/${R.operationId}`,L=(0,C().mergeURLSearchParams)({operationName:p,...(0,P().getLocaleAndCurrencyQueryString)(l)},l?.searchParams),v=o.default.get('layout-init'),T=(0,b().formatUrl)(x,L),U=O(x,l?.fetchOptions?.method??'POST',c),X=l?.fetchOptions&&'body'in l.fetchOptions?l.fetchOptions.body:void 0;return{...t,fetchUrl:T,context:{...l,searchParams:L,asyncHeaders:U,fetchOptions:{...l?.fetchOptions,body:X,headers:{...n,...l?.headers,...l?.fetchOptions?.headers,...t.headers,..._(X),'X-Airbnb-GraphQL-Platform':'web','X-Airbnb-GraphQL-Platform-Client':'minimalist-niobe','X-Niobe-Short-Circuited':'true',...v&&{'X-Client-Version':v?.appVersionFull},...(0,u.isCurrentDomainInChina)()?{[u.chinaPersonalizationHeaderName]:(0,u.loadChinaPersonalizationValueFromLocalStorage)().toString()}:{},...(0,S().default)(p,h)&&'no-cache'!==A&&!f.default.getBootstrap('sw_pwa_disable_niobe_cache')?{'X-Airbnb-SW-Fetch-Policy':A}:{}}}}}},e.contextRESTTransform=function({options:t,extraHeaders:n,metricReporter:o,flagger:c}){const{context:u,url:f,productContext:h}=t;if(A(f)){const t=(0,l().pathTraversalDetectedInRestURLError)(f);(0,l().reportNiobeError)(t),c.isTrebuchetLaunched((0,s.default)('web.niobe.prevent_path_traversal'))&&(0,l().throwNiobeError)(t)}const p=(0,C().mergeURLSearchParams)(t.excludeLocaleAndCurrencySearchParams?void 0:(0,P().getLocaleAndCurrencyQueryString)(),u?.searchParams,t.searchParams),y=t.method??u?.fetchOptions?.method??'GET',S=O(f,y,o),R=t.body??u?.fetchOptions?.body;return{...t,fetchUrl:(0,b().formatUrl)(f,p),context:{...u,searchParams:p,asyncHeaders:S,fetchOptions:{...u?.fetchOptions,method:y,body:R,headers:{..._(R),...n,...u?.headers,...u?.fetchOptions?.headers,...t.headers,...h&&{'X-Product-Context':h}}}}}};var n=r(d[1]),o=t(r(d[2])),c=t(r(d[3])),s=t(r(d[4])),u=r(d[5]),f=t(r(d[6]));function h(){const t=r(d[7]);return h=function(){return t},t}function l(){const t=r(d[8]);return l=function(){return t},t}function p(){const t=r(d[9]);return p=function(){return t},t}function b(){const t=r(d[10]);return b=function(){return t},t}function y(){const t=r(d[11]);return y=function(){return t},t}function P(){const t=r(d[12]);return P=function(){return t},t}function S(){const n=t(r(d[13]));return S=function(){return n},n}function C(){const t=r(d[14]);return C=function(){return t},t}function O(t,n,o){const c=(0,p().getRecaptchaPlatformHeaders)(t,n);if(c)return c.then(c=>{if(c)return o.increment('frontend.niobe.recaptcha_v3.append_header',1,{client:'minimalist',endpoint:t,method:n}),c}).catch(t=>{o.increment('frontend.niobe.recaptcha_v3.error',1,{client:'minimalist',status:String(t.statusCode),message:String(t.message)})})}function R(t){return'string'!=typeof t&&null!=t&&('undefined'!=typeof FormData&&t instanceof FormData||'undefined'!=typeof Blob&&t instanceof Blob||t instanceof ArrayBuffer||ArrayBuffer.isView(t)||'undefined'!=typeof ReadableStream&&t instanceof ReadableStream)}function _(t){return{...R(t)?{}:{'Content-Type':'application/json'},'X-Airbnb-API-Key':h().API_KEY,'X-CSRF-Token':(0,c.default)(),'X-CSRF-Without-Token':'1',...(0,n.buildAirlockPermitV2Header)()}}function A(t){if(t.includes('../')||t.includes('..\\'))return!0;try{const n=decodeURIComponent(t);return n.includes('../')||n.includes('..\\')}catch{return!1}}},"abc507",["ba7a76","a145d5","ef2bc3","40eeb7","2c6bf9","6d95ce","c235f8","286e0d","07f19c","f5568d","45f45a","f8aa06","4c8a33","d8c0f0","ab4631"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return t?.ghostingAppeal?.redirectUri??null}},"b1cb64",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.redirectToAirlockIfGhostingAppeal=function(l,c){const p=(0,t.getGraphqlGhostingAppealUri)(l);if(p)return c&&(0,o.logRetrierCancelled)(c,'ghostingAppeal'),(0,n.redirectToAirlock)(p),!0;return!1};var t=r(d[0]),o=r(d[1]),n=r(d[2])},"b7d934",["ea77fc","7ad8b2","c49192"]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(){return 4}function o({attemptsCount:t,retryDelay:o}){const n=void 0===o?2500:o,s=Math.min(n*2**t,6e4);return Math.floor(Math.random()*(s+1))}Object.defineProperty(e,"__esModule",{value:!0}),e.getTotalNetworkErrorRetrierAttempts=t,e.networkErrorRetrier=void 0;e.networkErrorRetrier=({retryOnNetworkError:t,retryDelay:n,options:{context:{networkErrorAttemptsCount:s=0,fetchOptions:u={}}={},operation:p},result:c})=>{if('mutation'===p?.type||'subscription'===p?.type)return;const y=c.response?.headers;if(y&&'true'===y.get('x-airbnb-halt-retry'))return;const h=!c.response||502===c.response.status||503===c.response.status||504===c.response.status;if(t&&h&&s<4){const t=o({attemptsCount:s+=1,retryDelay:n}),p=new Promise(o=>{setTimeout(o,t)}),c='object'==typeof u?.headers&&null!==u.headers?u.headers:{};return{context:p.then(()=>({networkErrorAttemptsCount:s,fetchOptions:{...u,headers:{...c,'x-airbnb-retry':String(s)}}})),reason:'networkError'}}}},"b7fb26",[]);
__d(function(g,_r,i,a,m,e,d){"use strict";var t=_r(d[0]).default;function r(){const t=_r(d[1]);return r=function(){return t},t}function n(){const t=_r(d[2]);return n=function(){return t},t}function o(){const t=_r(d[3]);return o=function(){return t},t}function s(){const t=_r(d[4]);return s=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.metricsTransform=function(t,r,n){return{...t,context:{...t.context,startTime:r(),eventId:n(),clientTraceId:t?.context?.clientTraceId||n()}}},e.reportAPIResponseMetrics=async function({flagger:t,jitneyLogger:n,apiEventAttemptId:s,apiRequestId:_,result:p,options:u}){const{fetchUrl:h,type:T,operationName:b,context:L}=u,{fetchOptions:I,networkErrorAttemptsCount:x,clientTraceId:A}=L,R=I?.method??'POST';let z;const S=await f(h);if(S){z={response_decompressed_size:E(S),first_byte_time_ms:y(S),network_protocol:k(S),dns_lookup_time_ms:v(S),header_size:w(S)}}if(p.metrics){const{networkStart:t,networkBodyEnd:r,contentLength:n,serverTiming:o,contentType:s}=p.metrics;let c;try{c=JSON.stringify((0,l().parseServerTiming)(o))}catch{c=o}z={...z,response_over_the_wire_size:n??void 0,response_time_ms:Math.floor(r-t),server_timing:c??void 0,content_type:s??void 0}}let q,M;'graphql'===T&&(q=3,M=b);'rest'===T&&(q=2);let O='http://unknown';void 0!==window.location&&(O=window.location.origin??O);const{host:P,pathname:B}=new URL(h,O);n({schema:o().UniversalApiResponseEvent,event_data:{client_trace_id:A,event_id:s,request_id:_,http_status_code:p.response?.status??0,http_method:r().HttpMethodType[R.charAt(0).toUpperCase()+R.slice(1).toLowerCase()],domain_and_path:`${P}${B}`,host:P,path:B,error_code:p.error?.name,api_protocol:q,api_operation_name:M,retry_number:x,...z}});const C=u.context.fetchOptions?.headers,N=C[c.AIRLOCK_REPLAY_HEADER];if(N){const r=u.context.airlockView;(0,c.logRequestReplayEvent)('requestReplayed',{flagger:t,jitneyLogger:n,airlockId:N,viewName:r,fetchUrl:h,requestId:_})}},e.reportCacheMetrics=function(t,r,o,c,p){if('rest'===r.type)return;if('cache'!==c&&'cache-prefetch'!==c&&'network'!==c)return;const{floor:h}=Math,{operationName:l,operationType:f,context:{startTime:y,clientTraceId:v,eventId:w=""},fetchPolicy:E}=r;const k=c.startsWith('cache'),T='cache-prefetch'===c,b=A(r);t({schema:s().UniversalNiobeResponseEvent,event_data:{...(function(){const t=h(p-(y??0)),r={total_response_latency_ms:t,total_latency_ms:t,first_response_latency_ms:t},{metrics:n}=o;if(!n)return{...r,niobe_client_overhead_ms:t};const{networkStart:s,networkBodyEnd:_,payloadParseLatency:u,contentLength:l}=n;if('cache'===c||'cache-prefetch'===c)return{...r,niobe_client_overhead_ms:t,cache_response_byte_size:l||void 0};const f=h(_-s),v=h(t-f);return{...r,network_deserialization_latency_ms:u,network_request_latency_ms:f,network_load_latency_ms:f,network_response_byte_size:l||void 0,cache_response_byte_size:l||void 0,niobe_client_overhead_ms:v}})(),...I(o),...x(r,o),event_id:w,client_trace_id:v,request_event_ids:o.metrics?.requestEventIds??[],operation_name:l,operation_type:n().ApiOperationType[f],request_strategy:R[E],operation_id:r.operation?.operationId,cache_type:k?2:void 0,cached_data_is_exact_match:k,cached_data_is_from_prefetch:k?T:void 0,had_cached_data:b?k:void 0,fetch_priority:'prefetch'===r.context.type?2:1,http_status_code:o.response?.status??0,was_cancelled:r.signal?.aborted||u().NiobeError.isAbortError(o.error),...r.enableAppSessionInstrumentation?{app_logging_context:_.default.getAppLoggingContext()}:{}}})};var c=_r(d[5]),_=t(_r(d[6])),p=t(_r(d[7]));function u(){const t=_r(d[8]);return u=function(){return t},t}function h(){const t=_r(d[9]);return h=function(){return t},t}function l(){const t=_r(d[10]);return l=function(){return t},t}async function f(t){if(!performance?.getEntriesByType)return null;await Promise.resolve();const r=performance.getEntriesByType('resource').filter(r=>r.name.includes(t));return r.length?r[r.length-1]:null}function y(t){return t.responseStart-t.requestStart}function v(t){return t.domainLookupEnd-t.domainLookupStart}function w(t){const r=t.transferSize-t.encodedBodySize;return Math.max(0,r)}function E(t){return t.decodedBodySize}function k(t){return t.nextHopProtocol}function T(t){return t?.errorType?t.errorType:1}function b(t){const{error:r,catchErrors:n,resultErrors:o}=t,{networkError:s,graphQLErrors:c}=r||{},_=[];if(n)for(const t of n)_.push({error_type:4,message:t.message,path:t.path?.join('.')??'',handled_by:1});if(o)for(const t of o)_.push({error_type:4,message:t.message,path:t.path?.join('.')??'',handled_by:2});if(c)for(const t of c)_.push({error_type:4,message:t.message,path:t.path?.join('.')??'',handled_by:3});return s&&_.push({error_type:T(s),message:s.message,handled_by:3,path:''}),_}function L(t){const{error:r,catchErrors:n,resultErrors:o}=t;return r?r.message:n?.length?(0,h().getLocalizedMessageFromGraphQLErrors)(n):o?.length?(0,h().getLocalizedMessageFromGraphQLErrors)(o):''}function I(t){const{error:r,catchErrors:n,resultErrors:o}=t;return{has_error:Boolean(r||n?.length||o?.length),unexpected_errors:b(t),fatal_error_message:L(t)}}function x(t,r){if('mutation'!==t.operationType)return null;const n='optimisticResponse'in t&&t.optimisticResponse;return{is_optimistic_mutation:Boolean(n),optimistic_response_changed:n?!(0,p.default)(n,r.data):void 0}}function A(t){const{fetchPolicy:r}=t;return['cache-and-network','cache-first','cache-only'].includes(r)}const R={'cache-and-network':'cacheAndNetwork','cache-first':'cacheFirst','cache-only':'cacheOnly','network-only':'networkOnly','no-cache':'noCache'}},"b80b94",["ba7a76","8ad2cc","8da96c","cb55a0","d106a1","a145d5","2bf1de","3dcd9d","00dfad","e38e79","2f6e7b"]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.redirectOnKrakenAuthenticationError=function(t){if(!t.error?.networkError)return!1;const{networkError:c}=t.error;if(401===c.statusCode&&u(c.result)){const t=c.result.redirect_url??'',[u,s]=t.split('?');if(u&&window.location.pathname!==u){let t;s&&(t=(0,n.default)(`?${s}`)),(0,o.replaceToHistory)(u,{maintainQueryParams:!0,params:t})}return!0}return!1};var n=t(r(d[1])),o=r(d[2]);function u(t){if(!t||'object'!=typeof t)return!1;const n=t;return 401===n.error_code&&'authentication_required'===n.error}},"bf6bc6",["ba7a76","a7c4ef","4ee5a9"]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(){const n=r(d[0]);return t=function(){return n},n}Object.defineProperty(e,"__esModule",{value:!0}),e.OPERATION_REGISTRY_VERSION=void 0,e.operationRegistryTransform=function(s,c){const{context:O,operation:{operationId:f,type:u}}=s,p={...s.extensions,persistedQuery:{version:n,sha256Hash:f}};if('query'===u&&!s.usePOSTForQuery&&!c){const n=(0,t().mergeURLSearchParams)(O.searchParams,{...s.variables?{variables:JSON.stringify(s.variables)}:{},extensions:JSON.stringify(p)});if(!n||n.toString().length<o)return{...s,context:{...O,operationId:f,searchParams:n,fetchOptions:{...O.fetchOptions,method:'GET',body:void 0}}}}return{...s,context:{...O,operationId:f,fetchOptions:{...O.fetchOptions,method:'POST',body:JSON.stringify({operationName:s.operationName,variables:s.variables,extensions:p})}}}};const n=e.OPERATION_REGISTRY_VERSION=1,o=3500},"c0fdc0",["ab4631"]);
__d(function(g,r,i,a,m,e,d){"use strict";var o=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.redirectToAirlock=function(o){window.location.href=o};o(r(d[1]))},"c49192",["ba7a76","cfeceb"]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(){const n=r(d[0]);return t=function(){return n},n}Object.defineProperty(e,"__esModule",{value:!0}),e.transformResponse=function(t,s){return t.data?n.reduce((t,n)=>n(t,s),t):t};const n=[function(n,s){return s?.caughtItemsLocators?.length?(0,t().catchErrorsInResponse)(n,s.caughtItemsLocators,'catch'):n},function(n,s){return s?.resultItemsLocators?.length?(0,t().catchErrorsInResponse)(n,s.resultItemsLocators,'result'):n}]},"c948ba",["74aeec"]);
__d(function(g,r,i,a,m,e,d){'use strict';Object.defineProperty(e,"__esModule",{value:!0});var n=e.UniversalApiResponseEvent={defaultProps:{schema:'com.airbnb.jitney.event.logging.Universal:UniversalApiResponseEvent:3.0.0',event_name:'universal_api_response'},propTypes:{}};n.logSndi=!0,n.fullyQualifiedName='Universal.v3.UniversalApiResponseEvent';e.UniversalApiResponseEventEvent=function(s){return{eventData:s,eventDataSchema:n}}},"cb55a0",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UnsubscribeMutationOperation=void 0;e.UnsubscribeMutationOperation={name:'UnsubscribeMutation',type:'mutation',operationId:'accc8115c189c60629025981d7d23d3a4e33de11783b0c489ea677185c6da47f'}},"ceadbe",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=class{constructor(t,s){if(this.code=void 0,this.status=void 0,this.url=void 0,!t)throw new ReferenceError('E03 (https://air.bb/hl-E03): URL is required');this.code='HYPERLOOP_REDIRECT',this.url=t,this.status=s||302}static isRedirect(t){return'HYPERLOOP_REDIRECT'===t?.code}}},"cfeceb",[]);
__d(function(g,r,i,a,m,e,d){'use strict';Object.defineProperty(e,"__esModule",{value:!0});var n=e.UniversalNiobeResponseEvent={defaultProps:{schema:'com.airbnb.jitney.event.logging.Universal:UniversalNiobeResponseEvent:1.0.0',event_name:'universal_niobe_response'},propTypes:{}};n.fullyQualifiedName='Universal.v1.UniversalNiobeResponseEvent';e.UniversalNiobeResponseEventEvent=function(s){return{eventData:s,eventDataSchema:n}}},"d106a1",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(n,u){return t.has(n)};const t=new Set(['GetTestUserQuery'])},"d8c0f0",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var o=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.airlockRetrier=void 0;var t=r(d[1]),l=o(r(d[2])),c=r(d[3]),n=r(d[4]),f=r(d[5]),s=r(d[6]),u=r(d[7]),v=r(d[8]),k=r(d[9]),R=r(d[10]),p=r(d[11]);e.airlockRetrier=({result:o,metricReporter:y,options:E,flagger:h,jitneyLogger:A,niobeClient:_})=>{const L=void 0,q=o;if((0,p.redirectToAirlockIfGhostingAppeal)(q,y))return;let w=null;if(w=o?.data?.client_error_info?(0,t.extractAirlockData)(o.data):(0,n.extractGraphqlAirlockError)(o.error?.graphQLErrors)||(0,t.extractAirlockData)(q),!w)return;(0,u.logAirlockLifecycleEvent)('RECEIVED_BY_FRONTEND',w);const I=(0,t.isLegacyAirlock)(w),N=(0,t.getAirlockId)(w)??void 0,U=(0,f.extractViewName)(w,I);return(0,l.default)({actionType:1,endpoint:E.fetchUrl,flow:U??void 0,airlockId:N??void 0}),(0,R.redirectToAirlockIfFullpage)(w,y)?void 0:{context:new Promise(o=>{(0,c.handleAirlockError)({airlock:w,onSuccess:()=>{if((0,k.logRetryCount)(y,!0,I,U),I&&!w.should_replay_request)return(0,v.logRequestReplayEvent)('requestNotReplayed',{flagger:h,jitneyLogger:A,airlockId:N,viewName:U??void 0,fetchUrl:E.fetchUrl}),void o(L);(0,v.logRequestReplayEvent)('waitForRequestReplay',{flagger:h,jitneyLogger:A,airlockId:N,viewName:U??void 0,fetchUrl:E.fetchUrl}),(0,u.logAirlockLifecycleEvent)('REQUEST_REPLAYED',w),o({fetchOptions:{headers:(0,s.getReplayAirlockHeader)(w)},airlockView:U??void 0})},onError:()=>{(0,k.logRetryCount)(y,!1,I,U),(0,v.logRequestReplayEvent)('requestNotReplayed',{flagger:h,jitneyLogger:A,airlockId:N,viewName:U??void 0,fetchUrl:E.fetchUrl}),o(L)},error:q,niobeClient:_})}),reason:'airlock'}}},"dff2e4",["ba7a76","1700a4","7b3a9c","ea32e0","29bae5","417c98","ecb272","94a171","7a6dd3","9f19fd","31ec22","b7d934"]);
__d(function(g,r,i,a,m,e,d){"use strict";function n(){const o=r(d[0]);return n=function(){return o},o}Object.defineProperty(e,"__esModule",{value:!0}),e.extractClientErrorInfo=function(o){if(o.client_error_info)return o.client_error_info;if(o?.data?.client_error_info)return o.data.client_error_info;if(n().NiobeError.isGraphQLErrors(o?.error))for(const n of o.error.cause){const o=n.extensions?.response?.body?.client_error_info;if(o)return o}return}},"e056b2",["00dfad"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){navigator.serviceWorker.controller?.postMessage({type:'NIOBE_RESULT_ERROR',key:t})}},"e15052",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getLocalizedMessageFromGraphQLErrors=void 0;e.getLocalizedMessageFromGraphQLErrors=o=>{for(const{extensions:s}of o)if(s?.localizedMessage)return s.localizedMessage}},"e38e79",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.buildAirlockPermitV2Header=function(){return{[t.AIRLOCK_PERMIT_V2_HEADER]:'true'}};var t=r(d[0])},"e41eda",["f3d6f1"]);
__d(function(g,r,i,a,m,e,d){"use strict";var o=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.handleAirlockError=function({airlock:o,onSuccess:c,onError:t,error:l,niobeClient:u}){n.default.emit('airlock:niobe:trigger',{airlock:o,onSuccess:c,onError:t,error:l,niobeClient:u})};var n=o(r(d[1]))},"ea32e0",["ba7a76","abc3e4"]);
__d(function(g,r,i,a,m,e,d){"use strict";var n=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.getGraphqlGhostingAppealUri=function(n){if(!n.error?.graphQLErrors)return;return n.error.graphQLErrors.map(n=>n.extensions?.response?.body).map(t.default).find(n=>null!=n)};var t=n(r(d[1]))},"ea77fc",["ba7a76","b1cb64"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getReplayAirlockHeader=function(n){const o=(0,t.getAirlockId)(n);return{[c.AIRLOCK_REPLAY_HEADER]:o??''}};var t=r(d[0]),c=r(d[1])},"ecb272",["1700a4","f3d6f1"]);
__d(function(g,r,i,a,m,e,d){"use strict";function t(){const o=r(d[0]);return t=function(){return o},o}Object.defineProperty(e,"__esModule",{value:!0}),e.NiobeQueryRef=void 0;class o{constructor(t){this.options=void 0,this.result=void 0,this.promise=void 0,this.clientType=void 0,this.deferred=void 0,this.taskController=void 0,this.clientType=t.clientType,this.deferred=t.deferred,this.options=t.options,this.promise=t.promise,this.result=t.result??null,this.taskController=t.options.context?.taskController,this.result||this.promise.then(t=>{this.result=t})}static for(s){const{result:n,promise:l}=s,c=o.memo.get(l),u=n&&o.memo.get(n),p=c||u;if(p){const o=p.clientType===s.clientType,{options:n}=p,{options:l}=s,c=JSON.stringify((0,t().convertToStableObjectOrder)(n))===JSON.stringify((0,t().convertToStableObjectOrder)(l));if(o&&c)return p}const h=new o(s);return o.memo.set(h.promise,h),h.result&&o.memo.set(h.result,h),h.promise.then(t=>o.memo.set(t,h)),h}}e.NiobeQueryRef=o,o.memo=new WeakMap},"ee1cae",["fad99e"]);
__d(function(g,r,i,a,m,e,d){"use strict";var n=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.handleAgentFriction=void 0;var t=n(r(d[1]));e.handleAgentFriction=({friction:n,onSuccess:o,onError:c,niobeClient:l})=>{t.default.emit('agentFriction:niobe:trigger',{friction:n,onSuccess:o,onError:c,niobeClient:l})}},"eebdbf",["ba7a76","abc3e4"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AIRLOCK_REPLAY_HEADER=e.AIRLOCK_PERMIT_V2_HEADER=void 0;e.AIRLOCK_REPLAY_HEADER='X-Airbnb-Replay-Airlock-Id',e.AIRLOCK_PERMIT_V2_HEADER='X-Airbnb-Supports-Airlock-V2'},"f3d6f1",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.getRecaptchaPlatformHeaders=function(t,n){if(!(0,o.deliverNiobeBotDetection)())return null;const c=(0,s.maybeGetRecaptchaV3TokenHeader)(t,n,!0);if(!c)return null;return c()},e.recaptchaRetrier=void 0;var n=t(r(d[1])),o=r(d[2]),c=r(d[3]),s=r(d[4]),u=t(r(d[5]));const h=t=>{if(void 0===t)return'unknown';const n=t[0];return'number'==typeof n?String(n):n},l=t=>{const{extensions:{errorClass:n,errorType:o,response:{statusCode:c}={}}={}}=t;return"ValidationRequiredException"===n||"validation_required"===o||440===c};e.recaptchaRetrier=({result:t,options:o,flagger:s})=>{if(s.isTrebuchetLaunched((0,n.default)('niobe_disable_recaptcha_retrier')))return;const f=t.error?.graphQLErrors?.find(l);if(!f)return;const p=h(f.path);return{context:(0,c.getRecaptchaV3TokenHeader)({action:p,timeoutInMs:5e3,maxRetries:5,shouldThrow:!0}).then(t=>{const n=o.context?.fetchOptions;return{fetchOptions:{...n,headers:{...n?.headers,...t}}}}).catch(()=>{(0,u.default)()}),reason:'recaptcha'}}},"f5568d",["ba7a76","2c6bf9","60f717","fa27ff","913737","178cf3"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getHostAndPath=function(n){return process?.env?.NIOBE_ENDPOINT?process.env.NIOBE_ENDPOINT:t};const t='/api/v3'},"f8aa06",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.httpResolver=async function({metricReporter:t,fetch:h,fetchStatusMessageTarget:f,clientRequestId:w,options:y,isRuntimeResponseMockingEnabled:E,flagger:N}){const{context:T,fetchUrl:v,multiAbortController:{signal:k},operation:O,operationName:_,variables:x}=y,{asyncHeaders:R,fetchOptions:S,clientTraceId:j}=T,C=S?.method??'POST',$={...R?await R:{},...S?.headers,'x-client-request-id':String(w),'x-airbnb-client-trace-id':String(j)};T.eventId&&Object.assign($,{'x-airbnb-network-log-link':String(T.eventId)});const A=S?.body,B=t.now(),I=h(v,{...S,body:A,signal:k,headers:$,method:C});try{const o=await I;f?.dispatchEvent((0,s().createFetchSuccessEvent)());const l=t.now(),{headers:h,ok:w,status:E,statusText:T}=o,v=h.get('content-type'),k=h.has('content-length')?Number(h.get('content-length')):null,O={ok:w,status:E,statusText:T,headers:(0,p().createNiobeHeaders)(h)},_=await o.text(),x=t.now(),R=N.isTrebuchetLaunched((0,n.default)('web.niobe.only_parse_json_responses')),S=Boolean(v?.includes('application/json')&&_.length);let j,C={};if(!R||S)try{const n=t.now();if('rest'===y.type){C={data:''===_?.trim()?{}:JSON.parse(_)}}else C=JSON.parse(_);j=Math.floor(t.now()-n)}catch(t){return b({message:`Network error (parse): ${t.message}`,response:O,body:_,errorType:3})}const $={contentType:v,contentLength:k,networkStart:B,networkHeadersEnd:l,networkBodyEnd:x,payloadParseLatency:j,serverTiming:h.get('server-timing')};let A;C.errors?.length?A=new(c().NiobeError)(C.errors):E>=300&&(A=new(c().NiobeError)(new(u().NiobeNetworkError)(`Received unexpected status code ${E}`,{body:_,errorType:2,statusCode:E,headers:O.headers})));const{data:M,extensions:F,client_error_info:H}=C;return{data:M,error:A,extensions:F,response:O,metrics:$,client_error_info:H}}catch(t){if((0,o.isAbortError)(t))return{data:null,error:new(c().NiobeError)(t)};f?.dispatchEvent((0,s().createFetchFailureEvent)());const n=t;if('ECONNABORTED'===n?.code){const t=(0,l().ssrTimeoutError)(_,n);return(0,l().reportNiobeError)(t),Object.assign(t,{code:'ECONNABORTED'}),{data:null,error:new(c().NiobeError)(t)}}return b({message:`Network error (connection): ${t.message}`,errorType:1})}};var n=t(r(d[1])),o=r(d[2]);function s(){const t=r(d[3]);return s=function(){return t},t}function c(){const t=r(d[4]);return c=function(){return t},t}function u(){const t=r(d[5]);return u=function(){return t},t}function l(){const t=r(d[6]);return l=function(){return t},t}function p(){const t=r(d[7]);return p=function(){return t},t}function b({message:t,response:n,body:o,errorType:s}){const l=new(u().NiobeNetworkError)(o?`${t}. Received body: ${o}`:t,{body:o,errorType:s,statusCode:n?.status,headers:n?.headers});return{data:null,error:new(c().NiobeError)(l),response:n}}},"f9267b",["ba7a76","2c6bf9","a2c93f","da80b1","00dfad","1004f3","07f19c","6e9310"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.convertToStableObjectOrder=function t(o){if(Array.isArray(o))return o.map(o=>t(o));if('object'==typeof o&&null!==o){const n=o;return'function'==typeof n.toJSON?t(n.toJSON()):Object.keys(o).sort().reduce((n,c)=>(n[c]=t(o[c]),n),{})}return o}},"fad99e",[]);
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/web/common/37a4.77f6cab3b5.js.map