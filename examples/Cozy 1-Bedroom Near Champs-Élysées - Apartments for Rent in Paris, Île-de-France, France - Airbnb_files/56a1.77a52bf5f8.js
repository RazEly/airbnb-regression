__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.useGetWishlistItemIds=function(){const t=(0,n.useContext)(x);if(!t)throw new Error('useGetWishlistItemIds must be used within a SaveToListStoreProvider');return(0,n.useCallback)((s,u)=>(0,p.getWishlistItemIds)(t.getState(),s,u),[t])},e.useIsEntitySavedToAnyList=function(t,s){const u=(0,n.useContext)(x);if(!u)throw new Error('useIsEntitySavedToAnyList must be used within a SaveToListStoreProvider');const o=(0,n.useMemo)(()=>u=>!!s&&(0,p.isEntitySavedToAnyList)(u,t,s),[s,t]);return(0,I.useStore)(u,o)},e.useIsEntitySavedToAnyListDeprecated=function(){const t=(0,n.useContext)(x);if(!t)throw new Error('useIsEntitySavedToAnyListDeprecated must be used within a SaveToListStoreProvider');const s=(0,n.useMemo)(()=>t=>t.wishlistItems,[]),u=(0,I.useStore)(t,s);return(0,n.useCallback)((t,s)=>(0,p.isEntitySavedToAnyList)({wishlists:[],wishlistItems:u},t,s),[u])},e.useMergeWishlistItems=function(t){const s=(0,n.useContext)(x);if(!s)throw new Error('useMergeWishlistSnapshot must be used within a SaveToListStoreProvider');(0,n.useEffect)(()=>{if(t&&t.length>0){const u={wishlists:[],wishlistItems:new Set(t.filter(w.default).map(M.createWishlistItemReplica))};s.merge(u)}},[t,s])},e.useMutationsSettledEffect=function(t){const s=(0,n.useContext)(x);if(!s)throw new Error('useMutationsSettledEffect must be used within a SaveToListStoreProvider');const u=(0,I.useStore)(s.allMutationsSettledCount,I.identitySelector),o=(0,S.useEvent)(t);(0,n.useEffect)(()=>{u>0&&o()},[o,u])},e.useSaveToListStoreDebugLogger=function({store:t}={}){const s=(0,o.useDebugLogger)('SaveToListStoreProvider'),u=(0,n.useContext)(x),l=t??u;(0,n.useEffect)(()=>l?.subscribe(t=>{s(()=>t)}),[s,l])},e.useWishlistMutations=function(){const t=(0,n.useContext)(x);if(!t)throw new Error('useWishlistMutations must be used within a SaveToListStoreProvider');const[s]=(0,l().useMutation)(c.default,{unsafe__shouldThrowErrors:!0}),[u]=(0,l().useMutation)(h.default,{unsafe__shouldThrowErrors:!0}),[o]=(0,l().useMutation)(f.default,{unsafe__shouldThrowErrors:!0});return{createWishlist:(0,n.useMemo)(()=>u=>t.createWishlist({mutate:s,options:u}),[s,t]),addWishlistItem:(0,n.useMemo)(()=>s=>t.addWishlistItem({mutate:u,options:s}),[u,t]),batchDeleteWishlistItems:(0,n.useMemo)(()=>s=>t.batchDeleteWishlistItems({mutate:o,options:s}),[o,t]),clear:t.clear}};var s=t(r(d[1])),u=t(r(d[2])),n=r(d[3]),o=r(d[4]);function l(){const t=r(d[5]);return l=function(){return t},t}var h=t(r(d[6])),f=t(r(d[7])),c=t(r(d[8])),S=r(d[9]),w=t(r(d[10])),v=r(d[11]),b=r(d[12]),p=r(d[13]),I=r(d[14]),M=r(d[15]);function y(){return{wishlists:[],wishlistItems:new Set}}var C=(0,u.default)("clientReplica"),E=(0,u.default)("mutationsQueue"),T=(0,u.default)("getStateCached"),W=(0,u.default)("getInitialStateCached"),L=(0,u.default)("broadcastChannel"),P=(0,u.default)("applyOptimisticUpdates");class _{constructor({initialSnapshot:t=y()}={}){Object.defineProperty(this,P,{value:O}),Object.defineProperty(this,C,{writable:!0,value:void 0}),Object.defineProperty(this,E,{writable:!0,value:void 0}),Object.defineProperty(this,T,{writable:!0,value:void 0}),Object.defineProperty(this,W,{writable:!0,value:void 0}),Object.defineProperty(this,L,{writable:!0,value:void 0}),this.allMutationsSettledCount=void 0,(0,s.default)(this,L)[L]='BroadcastChannel'in window?new BroadcastChannel("save_to_list_partial_state"):null,(0,s.default)(this,C)[C]=new I.Store(t),(0,s.default)(this,E)[E]=new b.MutationQueue({onMutationAdded:()=>{this.merge({})},onMutationSettled:t=>{this.merge(t??{}),setTimeout(()=>{(0,s.default)(this,E)[E].hasPendingMutations()||this.allMutationsSettledCount.setState(this.allMutationsSettledCount.getState()+1)},0),(0,s.default)(this,L)[L]?.postMessage({partialState:t,version:1})}}),this.subscribe=this.subscribe.bind(this),this.getState=this.getState.bind(this),this.getInitialState=this.getInitialState.bind(this),this.clear=this.clear.bind(this),(0,s.default)(this,T)[T]=null,(0,s.default)(this,W)[W]=(0,v.removeVersioningMetadata)((0,s.default)(this,C)[C].getInitialState()),this.allMutationsSettledCount=new I.Store(0),(0,s.default)(this,L)[L]&&((0,s.default)(this,L)[L].onmessage=t=>{1===t.data.version&&t.data.partialState&&(this.merge(t.data.partialState),(0,s.default)(this,E)[E].hasPendingMutations()||this.allMutationsSettledCount.setState(this.allMutationsSettledCount.getState()+1))})}getState(){return null==(0,s.default)(this,T)[T]&&((0,s.default)(this,T)[T]=(0,s.default)(this,P)[P]()),(0,s.default)(this,T)[T]}getInitialState(){return(0,s.default)(this,W)[W]}subscribe(t){return(0,s.default)(this,C)[C].subscribe(()=>t(this.getState()))}merge(t){(0,s.default)(this,T)[T]=null,(0,s.default)(this,C)[C].setState((0,v.merge)((0,s.default)(this,C)[C].getState(),t))}createWishlist(t){return(0,s.default)(this,E)[E].createWishlist(t)}addWishlistItem(t){return(0,s.default)(this,E)[E].addWishlistItem(t)}batchDeleteWishlistItems(t){return(0,s.default)(this,E)[E].batchDeleteWishlistItems(t)}clear(){(0,s.default)(this,T)[T]=null,(0,s.default)(this,C)[C].setState((0,s.default)(this,C)[C].getInitialState())}}function O(){return(0,s.default)(this,E)[E].applyOptimisticUpdates((0,s.default)(this,C)[C].getState())}const x=(0,n.createContext)((function(){const t=window.saveToListStore||new _;return window.saveToListStore=t,t})())},"10c8a3",["ba7a76","76718e","99527b","07aa1f","f8ea9a","068abc","bd6cf7","f9f96a","d7b2e2","f4e9c4","58861b","e06512","957ea8","3e7627","d0f410","1b9467"]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,u){const{location:{search:s}}=window,{adults:f=0,infants:h=0,children:o=0,pets:k=0,checkin:p,checkout:_,check_in:I,check_out:y,flexible_date_search_filter_type:O,flexible_days:b}=n().default.parse(s,{ignoreQueryPrefix:!0}),x=t?null:I||p,v=t?null:y||_,D={adults:parseInt(f,10),infants:parseInt(h,10),children:parseInt(o,10),pets:parseInt(k,10),checkIn:x&&(0,c.default)(x).isValid()?(0,c.default)(x).format(l):null,checkOut:v&&(0,c.default)(v).isValid()?(0,c.default)(v).format(l):null,flexibleDateSearchFilterType:null==O?void 0:parseInt(O,10),flexibleDays:b};return{...D,...u,checkIn:t?D.checkIn:u?.checkIn??D.checkIn,checkOut:t?D.checkOut:u?.checkOut??D.checkOut}};var c=t(r(d[1]));function n(){const c=t(r(d[2]));return n=function(){return c},c}const l='YYYY-MM-DD'},"18db38",["ba7a76","1772c9","e950a3"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createWishlistItemReplica=function(t){const o=null!=t.version?Number.parseInt(t.version,10):-1,s={wishlistId:void 0,productId:void 0,productType:void 0,wishlistItemId:void 0,deletedAt:void 0};return Object.keys(t).forEach(n=>{const c=n;s[c]={version:o,value:t[c]??null}}),s}},"1b9467",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SaveToListHeartsUIKey=void 0;var t=r(d[0]);const s={onSaveableEntityRead:null,autoSaveWishlist:null};e.SaveToListHeartsUIKey=(0,t.createUIKey)('save-to-list-hearts',{getDefault:()=>s})},"39dfae",["005fd5"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MutationIdRegistryContext=void 0,e.useGenerateMutationId=function(){const{registerMutationId:o}=(0,t.useContext)(u);return(0,t.useCallback)(()=>{const t=`W-${(0,n().v4)()}`;return o(t),t},[o])},e.useMutationIdRegistry=function(){const n=(0,t.useRef)([]);return(0,t.useMemo)(()=>({registerMutationId:t=>{n.current.push(t)},isMutationIdRegistered:t=>n.current.includes(t)}),[])};var t=r(d[0]);function n(){const t=r(d[1]);return n=function(){return t},t}const u=e.MutationIdRegistryContext=(0,t.createContext)({registerMutationId:()=>{},isMutationIdRegistered:()=>!1})},"3a6972",["07aa1f","305dd5"]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.getWishlistItemIds=o,e.isEntitySavedToAnyList=function(t,n,u){return o(t,n,u).length>0};var n=r(d[1]),u=t(r(d[2]));function o(t,o,s){return Array.from(t.wishlistItems).filter(t=>{const{productType:u,productId:l}=t;if(!l||!u||!(u in n.ProductTypeToEntityType))return!1;const c=n.ProductTypeToEntityType[u],y=l;return null==t.deletedAt&&c===o&&y===s}).map(t=>t.wishlistItemId).filter(u.default)}},"3e7627",["ba7a76","7ee7e4","58861b"]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;function l(){const t=r(d[1]);return l=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.WishlistEntityTypeToItemType=void 0,e.getDefaultNameFromPayload=function(t){const s=t?.presentation?.wishlistSaveToModal?.defaultWishlistName??null;return(0,l().hasError)(s)?null:s},e.legacyListsFromPayload=function(t){return t?.presentation?.wishlistIndexPage?.wishlists?.filter(o.default).map(c)};var s=r(d[2]),n=r(d[3]),u=t(r(d[4])),o=t(r(d[5]));function c({collaboratorUsers:t,createdBy:l,dateRangeDetails:s,formattedDateRange:c,guestCount:_,guestDetails:E,id:I,isCollaborative:f,isCollaborativeBasedOnShareToken:p,isPrivate:C,name:h,pictures:N,productIds:T,userId:P,wishlistUser:A,xlImageUrl:b}){return{airbnb_canonical_place_ids:(0,n.extractIds)(T?.airbnbCanonicalPlaceIds,n.ENTITY_REGEXES[u.default.AIRBNB_CANONICAL_PLACE]),checkin:s?.checkIn||void 0,checkout:s?.checkOut||void 0,collaboratorUsers:t,created_by:l,formattedDateRange:c,guests:_||1,guest_details:{localized_description:E?.description?.localizedString||'',number_of_adults:E?.numberOfAdults||1,number_of_children:E?.numberOfChildren||0,number_of_infants:E?.numberOfInfants||0},id:parseInt((0,n.extractId)(I),10),image_url:N?.[0]?.largePicture||void 0,isCollaborative:f||p,listings_count:T?.stayIds.length||0,listing_ids_str:(0,n.extractIds)(T?.stayIds,n.ENTITY_REGEXES[u.default.LISTING]),mt_templates_count:T?.experienceIds.length||0,mt_template_ids:(0,n.extractIds)(T?.experienceIds,n.ENTITY_REGEXES[u.default.EXPERIENCE]),name:h||'',picture_urls:N?.map(t=>t?.largePicture).filter(o.default),places_count:(T?.placeIds.length||0)+(T?.airbnbCanonicalPlaceIds.length||0),place_ids:(0,n.extractIds)(T?.placeIds,n.ENTITY_REGEXES[u.default.PLACE]),private:C&&!p,thumbnail_image_url:N?.[0]?.largePicture||void 0,user:A&&P?{first_name:A.firstName,has_profile_pic:!!A.thumbnailUrl,id:parseInt(P,10),idStr:P,picture_url:A.thumbnailUrl,smart_name:A.firstName,thumbnail_url:A.thumbnailUrl}:null,user_id:P||void 0,wishlistUser:A,xl_image_url:b||void 0}}e.WishlistEntityTypeToItemType={[u.default.LISTING]:'HOME',[u.default.EXPERIENCE]:'EXPERIENCE',[u.default.PLACE]:'PLACE',[u.default.AIRBNB_CANONICAL_PLACE]:'AIRBNB_CANONICAL_PLACE'},u.default.LISTING,s.VERTICAL_TYPES.homes,u.default.EXPERIENCE,s.VERTICAL_TYPES.experiences,u.default.PLACE,s.VERTICAL_TYPES.places,u.default.AIRBNB_CANONICAL_PLACE,s.VERTICAL_TYPES.places},"3f2e27",["ba7a76","068abc","8e0668","cfb703","d1b3af","58861b"]);
__d(function(g,r,i,a,m,e,d){"use strict";var s=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.dismissToastDispatch=function(s){return{...s,newToastVisible:!1}},e.errorToastDispatch=function(s,l){const{errorDisplayMessage:n=null,errorDisplayTitle:o=null}=l??{};return{...s,newToast:{actionText:null,title:o,message:n??t.default.t('shared.modal error'),ariaLiveMessage:null,imgSrc:null,wishlistName:null,onActionPress:null,isError:!0,key:null},newToastVisible:!0}},e.removedToastDispatch=function(s,l,n,o){return{...s,newToast:{actionText:null,message:t.default.t('wishlist.toast_message_removed_from_wishlist'),ariaLiveMessage:t.default.t('wishlist.toast_message_removed_from_wishlist',{bold_start:'',bold_end:'',wishlist_name:l}),imgSrc:n??null,wishlistName:l,onActionPress:null,title:null,isError:!1,key:o},newToastVisible:!0}},e.savedToastDispatch=function(s,l,n,o,u){return{...s,newToast:{actionText:t.default.t('wish_list.button.change_wish_list'),message:t.default.t('wishlist.toast_message_saved_to_wishlist'),ariaLiveMessage:null,imgSrc:n.imgSrc??null,wishlistName:l??null,onActionPress:o,title:null,isError:!1,key:u},newToastVisible:!0}};var t=s(r(d[1]))},"44059a",["ba7a76","a9f4b1"]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.useAutoSaveWishlist=function(){const[{autoSaveWishlist:t}]=(0,y.useUIState)(T.SaveToListHeartsUIKey);return t},e.useHandleHeartClick=k,e.useInvalidateListsCache=E,e.useIsSaved=b,Object.defineProperty(e,"usePrewarmWishlistItems",{enumerable:!0,get:function(){return L.usePrewarmWishlistItems}}),e.useWishlists=function(){const[{lists:t}]=(0,y.useUIState)(f.SaveToListModalUIKey),s=E();return{lists:t,invalidateListsCache:s}};var s=r(d[1]),n=r(d[2]),l=r(d[3]),o=r(d[4]),u=r(d[5]),c=t(r(d[6])),I=r(d[7]),h=r(d[8]),v=r(d[9]),y=r(d[10]),S=t(r(d[11])),U=r(d[12]),p=r(d[13]),T=r(d[14]),f=r(d[15]),W=r(d[16]),_=r(d[17]),w=r(d[18]),L=r(d[19]);function b(t,n){const[{onSaveableEntityRead:l}]=(0,y.useUIState)(T.SaveToListHeartsUIKey),o=n?(0,_.getEntityId)(n):null,u=(0,w.useIsEntitySavedToAnyList)(t,o);return(0,s.useEffect)(()=>{o&&l?.(t,o)},[t,o,l]),u}function k(){const t=(0,w.useGetWishlistItemIds)(),{addWishlistItem:s,batchDeleteWishlistItems:o}=(0,w.useWishlistMutations)(),W=(0,h.useGenerateMutationId)(),L=(0,y.useUpdateUIState)(f.SaveToListModalUIKey),b=(0,y.useUpdateUIState)(T.SaveToListHeartsUIKey),k=(0,y.useUIStateGetter)(f.SaveToListModalUIKey),E=(0,y.useUIStateGetter)(T.SaveToListHeartsUIKey);return(0,v.useEvent)(async({entityType:h,entityId:v,imgSrc:y,photoId:T,productType:f,saveToListTarget:w,onSave:H,onUnsave:K,saveWithoutDates:A=!1,savingFrom:C,savingContext:M,sectionTypeUid:D,entityFilters:F})=>{if(!v)return;const{lists:O}=k(),{autoSaveWishlist:B}=E(),G=(0,_.getEntityId)(v),J=(w??B)?.id,P=S.default.isLoggedIn();L(U.dismissToastDispatch);const x=t(h,G),N=(0,c.default)(A,F),V={checkin:N.checkIn??void 0,checkout:N.checkOut??void 0,guests:(N?.adults||0)+(N?.children||0),target_id:G,target_type:(0,I.getTargetType)(h,f),section_type_uid:D,target_extra_data:{user_wishlist_ids:JSON.stringify(O?.map(({id:t})=>t)),is_logged_in:P.toString(),saving_from:C??'unknown',save_without_dates:A?.toString()||'false',saving_context:JSON.stringify(M)}},j={entityType:h,entityId:G,imgSrc:y,photoId:T,productType:f,eventData:V,entityFilters:F};if((0,I.logWishlistJitneyEvent)('saved.heart.listingHeart',{list_id:J?.toString(),...V}),P)if(x.length>0){const{data:t}=await(0,p.handleBatchDeleteWishlistItemsUIState)(async t=>o({variables:{wishlistItemIds:x,checkWishlistItemNotesBeforeUnsave:!t,checkWishlistItemVotesBeforeUnsave:!t}}).promise,L,y);(0,p.isBatchDeleteFailure)(t)||((0,I.logWishlistJitneyEvent)('saved.heart.listingHeart.unsave',{list_id:t?.batchDeleteWishlistItemsByWishlistItemId?.deletedWishlistItems?.[0]?.wishlistId??void 0,...V,checkin:void 0,checkout:void 0,guests:void 0}),K?.())}else if(null!=J){const{data:t}=await(0,p.handleAddWishlistItemUIState)(async()=>s({variables:{wishlistId:(0,n.createGlobalId)('Wishlist',J.toString()),savedItemType:l.WishlistEntityTypeToItemType[h],savedItemId:G,photoId:T,productType:f,mutationId:W(),treatmentFlags:(0,u.getAddWishlistItemTreatmentFlags)(),...N}}),L,b,j,M);(0,p.isAddItemFailure)(t)||H?.(t?.addWishlistItem?.wishlistItem?.wishlistItemId??null)}else L(t=>({...t,visible:!0,activeEntity:j}));else L(t=>({...t,requiresSignup:!0,visible:!0,activeEntity:j}))})}function E(){const t=(0,y.useUpdateUIState)(T.SaveToListHeartsUIKey),n=(0,y.useUpdateUIState)(f.SaveToListModalUIKey),l=(0,y.useUpdateUIState)(W.WishlistItemsAsyncQueryUIKey),{clear:u}=(0,w.useWishlistMutations)();return(0,s.useCallback)(s=>{const{shouldAlertOtherTabs:c=!1}=s||{};n(t=>({...t,networkCacheVersion:t.networkCacheVersion+1})),t(t=>({...t,autoSaveWishlist:null})),l(t=>({...t,seenAsyncQueryItems:new Set})),u(),c&&(0,o.broadcastSaveToListUpdate)()},[u,l,t,n])}e.default=function(t,s){const n=b(t,s),l=k();return{isSaved:n,handleHeartClick:(0,v.useEvent)(n=>l({...n,entityType:t,entityId:s}))}}},"4710c3",["ba7a76","07aa1f","56afe0","3f2e27","e3accc","821edf","18db38","6668de","3a6972","f4e9c4","afdc80","06a99e","44059a","e3a3dd","39dfae","f96184","648055","6a67c5","10c8a3","ef82e2"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WishlistItemsAsyncQueryUIKey=void 0;var t=r(d[0]);const s={seenAsyncQueryItems:new Set,tenantIntegrationInitialNetworkCacheVersion:new WeakMap};e.WishlistItemsAsyncQueryUIKey=(0,t.createUIKey)('save-to-list-wishlist-items-async-query',{getDefault:()=>s})},"648055",["005fd5"]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;function n(){const t=r(d[1]);return n=function(){return t},t}function o(){const t=r(d[2]);return o=function(){return t},t}Object.defineProperty(e,"__esModule",{value:!0}),e.getTargetType=function(t,n){if('listing'===t)return'STAY';if('experience'===t)return n??'EXPERIENCE';return'OTHER'},e.logWishlistJitneyEvent=function(t,s){u.default.logJitneyEvent({schema:o().UniversalComponentActionEvent,event_data:{logging_id:t,method:'onPress',uuid:(0,n().v4)(),operation:2,ancestor_logging_ids:[],ancestor_uuids:[],event_data:JSON.stringify(s),event_data_schema:"Saved.v3.WishlistDetailData"}})};var u=t(r(d[3]))},"6668de",["ba7a76","305dd5","08dcd9","c8b97a"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getEntityId=function(n){try{return['ActivityListing','DemandStayListing'].includes((0,t.getTypenameSafe)(n)||'')?(0,t.getInternalId)(n):n}catch{return n}};var t=r(d[0])},"6a67c5",["56afe0"]);
__d(function(g,r,i,a,m,e,d){"use strict";var E=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ProductTypeToV3PropertyName=e.ProductTypeToEntityType=e.EntityTypeToProductType=void 0;var t=E(r(d[1]));t.default.LISTING,t.default.EXPERIENCE,t.default.PLACE,t.default.AIRBNB_CANONICAL_PLACE,e.ProductTypeToEntityType={HOME:t.default.LISTING,EXPERIENCE:t.default.EXPERIENCE,PLACE:t.default.PLACE,AIRBNB_CANONICAL_PLACE:t.default.AIRBNB_CANONICAL_PLACE},e.EntityTypeToProductType={[t.default.LISTING]:'HOME',[t.default.EXPERIENCE]:'EXPERIENCE',[t.default.PLACE]:'PLACE',[t.default.AIRBNB_CANONICAL_PLACE]:'AIRBNB_CANONICAL_PLACE'},e.ProductTypeToV3PropertyName={HOME:'stayIds',EXPERIENCE:'experienceIds',PLACE:'placeIds',AIRBNB_CANONICAL_PLACE:'airbnbCanonicalPlaceIds'}},"7ee7e4",["ba7a76","d1b3af"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getAddWishlistItemTreatmentFlags=function(){return['tenantIntegration']}},"821edf",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VERTICAL_TYPES=e.LAST_UPDATE_SESSION_STORAGE_KEY=void 0;e.LAST_UPDATE_SESSION_STORAGE_KEY='SAVE_TO_LIST_LAST_UPDATE',e.VERTICAL_TYPES={homes:'Homes',experiences:'Experiences',places:'Places',services:'Services'}},"8e0668",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.MutationQueue=void 0;var s=t(r(d[1])),l=t(r(d[2])),u=r(d[3]),n=t(r(d[4])),o=r(d[5]),h=r(d[6]);function c({mutate:t}){let s,l;return{promise:new Promise((t,u)=>{s=t,l=u}),mutate:async(...u)=>{try{const l=await t(...u);return s(l),l}catch(t){throw l(t),t}}}}var f=(0,l.default)("queue"),p=(0,l.default)("onMutationAdded"),I=(0,l.default)("onMutationSettled"),w=(0,l.default)("nextOptimisticID"),v=(0,l.default)("resolvedOptimisticIDs"),b=(0,l.default)("rejectedOptimisticIDs"),y=(0,l.default)("addMutation"),O=(0,l.default)("generateOptimisticID"),M=(0,l.default)("resolveOptimisticId");function P({mutation:t,optimisticUpdate:l}){const u=(0,s.default)(this,f)[f].map(({promise:t})=>t),n=Promise.allSettled(u),o=(async()=>{let l;u.length&&await n;try{l=await t()}finally{(0,s.default)(this,f)[f].shift(),(0,s.default)(this,I)[I]?.(l)}})(),h={promise:o,optimisticUpdate:l};return(0,s.default)(this,f)[f].push(h),(0,s.default)(this,p)[p]?.(),o}function S(){return"optimistic-id:"+(0,s.default)(this,w)[w]++}function W(t){if(!t.startsWith('optimistic-id:'))return t;const l=(0,s.default)(this,v)[v].get(t);return l||null}e.MutationQueue=class{constructor(t={}){Object.defineProperty(this,M,{value:W}),Object.defineProperty(this,O,{value:S}),Object.defineProperty(this,y,{value:P}),Object.defineProperty(this,f,{writable:!0,value:[]}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,I,{writable:!0,value:void 0}),Object.defineProperty(this,w,{writable:!0,value:0}),Object.defineProperty(this,v,{writable:!0,value:void 0}),Object.defineProperty(this,b,{writable:!0,value:void 0}),t.onMutationAdded&&((0,s.default)(this,p)[p]=t.onMutationAdded),t.onMutationSettled&&((0,s.default)(this,I)[I]=t.onMutationSettled),(0,s.default)(this,v)[v]=new Map,(0,s.default)(this,b)[b]=new Set}hasPendingMutations(){return(0,s.default)(this,f)[f].length>0}applyOptimisticUpdates(t){return(0,s.default)(this,f)[f].reduce((t,{optimisticUpdate:s})=>s(t),(0,o.removeVersioningMetadata)(t))}createWishlist({mutate:t,options:l}){const{mutate:u,promise:n}=c({mutate:t}),o=(0,s.default)(this,O)[O]();return(0,s.default)(this,y)[y]({mutation:async()=>{const{name:t}=l?.variables??{},{data:n,error:h}=await u(l),c=n?.createWishlist?.wishlistId;if(!h&&t&&c){const l={id:{version:-1,value:c},name:{version:-1,value:t},deletedAt:{version:-1,value:null}};return(0,s.default)(this,v)[v].set(o,c),{wishlists:[l]}}return(0,s.default)(this,b)[b].add(o),{}},optimisticUpdate:t=>{const{name:s}=l?.variables??{},u={id:o,name:s,deletedAt:null};return{...t,wishlists:[u,...t.wishlists]}}}),{promise:n,optimisticWishlistId:o}}addWishlistItem({mutate:t,options:l}){const{mutate:n,promise:o}=c({mutate:t}),f=(0,s.default)(this,O)[O]();return(0,s.default)(this,y)[y]({mutation:async()=>{const{savedItemId:t,savedItemType:o,wishlistId:c}=l?.variables??{},p=(0,s.default)(this,M)[M]((0,u.extractId)(c));if(p){const{data:c,error:I}=await n(l&&{...l,variables:l.variables&&{...l.variables,wishlistId:(0,u.encodeId)(p)}}),w=c?.addWishlistItem?.wishlistItem;if(!I&&t&&o&&p&&w&&w.wishlistItemId)return(0,s.default)(this,v)[v].set(f,w.wishlistItemId),{wishlists:[],wishlistItems:new Set([(0,h.createWishlistItemReplica)(w)])}}return(0,s.default)(this,b)[b].add(f),{}},optimisticUpdate:t=>{const{savedItemId:n,savedItemType:o,wishlistId:h}=l?.variables??{},c=(0,u.extractId)(h);if((0,s.default)(this,b)[b].has(c))return t;const p={wishlistId:(0,s.default)(this,M)[M](c)??c,productId:n,productType:o,wishlistItemId:f,deletedAt:null};return{...t,wishlistItems:new Set([...t.wishlistItems,p])}}}),{promise:o,optimisticWishlistItemId:f}}batchDeleteWishlistItems({mutate:t,options:l}){const{mutate:u,promise:o}=c({mutate:t}),f=(new Date).toISOString();return(0,s.default)(this,y)[y]({mutation:async()=>{const{wishlistItemIds:t}=l?.variables??{},o=(t??[]).filter(n.default).map(t=>(0,s.default)(this,M)[M](t));if(o.every(n.default)){const{data:t,error:s}=await u(l&&{...l,variables:l.variables&&{...l.variables,wishlistItemIds:o}}),c=t?.batchDeleteWishlistItemsByWishlistItemId?.deletedWishlistItems;if(!s&&c)return{wishlists:[],wishlistItems:new Set(c.filter(n.default).map(t=>(0,h.createWishlistItemReplica)({version:t?.version,wishlistItemId:t?.wishlistItemId,deletedAt:t?.deletedAt??(new Date).toISOString()})))}}return{}},optimisticUpdate:t=>{const{wishlistItemIds:u}=l?.variables??{},o=(u??[]).filter(n.default).filter(t=>!(0,s.default)(this,b)[b].has(t)).map(t=>(0,s.default)(this,M)[M](t)??t),h=[...t.wishlistItems].map(t=>({...t,deletedAt:t.wishlistItemId&&o.includes(t.wishlistItemId)?f:t.deletedAt}));return{...t,wishlistItems:new Set(h)}}}),{promise:o}}}},"957ea8",["ba7a76","76718e","99527b","cfb703","58861b","e06512","1b9467"]);
__d(function(g,r,i,a,m,e,d){
/**
   * @license React
   * use-sync-external-store-with-selector.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   */
"use strict";var u=r(d[0]);var n="function"==typeof Object.is?Object.is:function(u,n){return u===n&&(0!==u||1/u==1/n)||u!=u&&n!=n},t=u.useSyncExternalStore,l=u.useRef,c=u.useEffect,f=u.useMemo,o=u.useDebugValue;e.useSyncExternalStoreWithSelector=function(u,v,s,S,h){var V=l(null);if(null===V.current){var b={hasValue:!1,value:null};V.current=b}else b=V.current;V=f(function(){function u(u){if(!c){if(c=!0,t=u,u=S(u),void 0!==h&&b.hasValue){var f=b.value;if(h(f,u))return l=f}return l=u}if(f=l,n(t,u))return f;var o=S(u);return void 0!==h&&h(f,o)?(t=u,f):(t=u,l=o)}var t,l,c=!1,f=void 0===s?null:s;return[function(){return u(v())},null===f?void 0:function(){return u(f())}]},[v,s,S,h]);var y=t(u,V[0],V[1]);return c(function(){b.hasValue=!0,b.value=y},[y]),o(y),y}},"995183",["07aa1f"]);
__d(function(g,r,i,a,m,e,d){'use strict';m.exports=r(d[0])},"addeb5",["995183"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={name:'AddWishlistItemMutation',type:'mutation',operationId:'ac11dcf7c8a1585735f653e75baa90aff8625885eedf1c719ccf677cdbf9e408'}},"bd6cf7",[]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ENTITY_REGEXES=void 0,e.encodeId=function(t,c){switch(c){case n.default.LISTING:return btoa(`StayListing:${t}`);case n.default.EXPERIENCE:return btoa(`ExperienceListing:${t}`);case n.default.PLACE:return btoa(`PlaceListing:${t}`);case n.default.AIRBNB_CANONICAL_PLACE:return btoa(`WishlistCanonicalPlaceListing:${t}`);default:return btoa(`Wishlist:${t}`)}},e.extractId=u,e.extractIds=function(t,n){return t?.map(t=>u(t,n))??[]};var n=t(r(d[1]));const c=/Wishlist:(.*)/;e.ENTITY_REGEXES={[n.default.LISTING]:/StayListing:(.*)/,[n.default.EXPERIENCE]:/ExperienceListing:(.*)/,[n.default.PLACE]:/PlaceListing:(.*)/,[n.default.AIRBNB_CANONICAL_PLACE]:/WishlistCanonicalPlaceListing:(.*)/};function s(t){return'function'==typeof atob?atob(t||''):Buffer.from(t||'','base64').toString()}function u(t,n){const u=s(t),o=(n||c).exec(u);return decodeURIComponent(o?o[1]:'')}},"cfb703",["ba7a76","d1b3af"]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.identitySelector=e.Store=void 0,e.useStore=function(t,s){return(0,n.useSyncExternalStoreWithSelector)(t.subscribe,t.getState,t.getInitialState,s)};var s=t(r(d[1])),u=t(r(d[2])),l=t(r(d[3])),n=r(d[4]),S=(0,u.default)("initialState"),b=(0,u.default)("state");e.Store=class{constructor(t){Object.defineProperty(this,S,{writable:!0,value:void 0}),Object.defineProperty(this,b,{writable:!0,value:void 0}),(0,s.default)(this,S)[S]=t,(0,s.default)(this,b)[b]=(0,l.default)(t),this.subscribe=this.subscribe.bind(this),this.getState=this.getState.bind(this),this.getInitialState=this.getInitialState.bind(this)}getState(){return(0,s.default)(this,b)[b].getState()}getInitialState(){return(0,s.default)(this,S)[S]}setState(t){return(0,s.default)(this,b)[b].setState(t)}subscribe(t){return(0,s.default)(this,b)[b].subscribe(t)}};e.identitySelector=t=>t},"d0f410",["ba7a76","76718e","99527b","319658","addeb5"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={name:'CreateWishlistMutation',type:'mutation',operationId:'c3e7e1b9e9f501efcac10d111706a86093d48bb8377a772b26fc0114ba5dc934'}},"d7b2e2",[]);
__d(function(g,r,i,a,m,e,d){"use strict";function s(s,t){return null==s?t:null==t||s.version>t.version?s:t}Object.defineProperty(e,"__esModule",{value:!0}),e.merge=function(t,l){const n={wishlists:t.wishlists.map(s=>({...s})),wishlistItems:new Set([...t.wishlistItems].map(s=>({...s})))};l.wishlists&&l.wishlists.forEach(t=>{const l=n.wishlists.find(s=>null!=s.id?.value&&s.id?.value===t.id?.value);l?Object.keys(t).forEach(n=>{l[n]=s(l[n],t[n])}):n.wishlists.unshift(t)});l.wishlistItems&&l.wishlistItems.forEach(t=>{const l=[...n.wishlistItems].find(s=>null!=s.wishlistItemId?.value&&s.wishlistItemId?.value===t.wishlistItemId?.value);l?Object.keys(t).forEach(n=>{l[n]=s(l[n],t[n])}):n.wishlistItems.add(t)});return n},e.removeVersioningMetadata=function(s){return{wishlists:s.wishlists.map(s=>Object.fromEntries(Object.entries(s).map(([s,t])=>[s,t?.value]))),wishlistItems:new Set([...s.wishlistItems].map(s=>Object.fromEntries(Object.entries(s).map(([s,t])=>[s,t?.value]))))}}},"e06512",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.handleAddWishlistItemUIState=function(o,u,c,h,I){let v;return l({mutate:async()=>{const{promise:l,optimisticWishlistItemId:n}=await o();return v=()=>{(0,t.logWishlistJitneyEvent)('saved.heart.updateWishlist',{...h.eventData}),u(t=>(0,s.dismissToastDispatch)({...t,visible:!0,wishlistItemIdToRemove:n}))},l},isFailure:n,onSuccess({addWishlistItem:t}){const{statusCode:l,wishlistItem:n}=t??{},{wishlistName:o,wishlistId:W,wishlistItemId:w,version:y}=n??{};'OK'===l&&null!=o&&null!=W&&(u(t=>({...(0,s.savedToastDispatch)(t,o,h,v,`${w}-${y}`),activeEntity:h})),c(t=>t.autoSaveWishlist?.id!==W?{...t,autoSaveWishlist:{id:W,savingContext:I}}:t))},onFailure(t){u(l=>{const n=t?.addWishlistItem?.errorContent??null;return{...(0,s.errorToastDispatch)(l,n),autoSaveWishlist:null}}),c(t=>t.autoSaveWishlist?{...t,autoSaveWishlist:null}:t)}})},e.handleBatchDeleteWishlistItemsUIState=async function(t,n,u){const c=t=>{const{statusCode:l,deletedWishlistItems:o=[]}=t?.batchDeleteWishlistItemsByWishlistItemId??{},{wishlistName:c,wishlistItemId:h,version:I}=o?.[0]??{};'OK'===l&&null!=c&&n(t=>(0,s.removedToastDispatch)(t,c,u,`${h}-${I}`))};let h;const I=new Promise(t=>{h=t});let v;v=await l({mutate:()=>t(!1),isFailure:o,onSuccess:c,onFailure(u){const{statusCode:I,wishlistItemVotesBlockedUnsave:W,wishlistItemNotesBlockedUnsave:w,userMessageTitle:y=null,userMessageSubtitle:D=null}=u?.batchDeleteWishlistItemsByWishlistItemId??{};n('OK'!==I&&(w||W)?u=>({...u,unsaveNoteConfirmation:{isOpen:!0,title:y,subtitle:D,async onCancel(){h()},async onRemove(){v=await l({mutate:()=>t(!0),isFailure:o,onSuccess:c,onFailure:()=>{n(s.errorToastDispatch)}}),h()}}}):s.errorToastDispatch)}}),o(v.data)&&await I;return v},e.isAddItemFailure=n,e.isBatchDeleteFailure=o;var t=r(d[0]),s=r(d[1]);async function l({mutate:t,isFailure:s,onSuccess:l,onFailure:n}){let o,u;try{const s=await t();return o=s.data,u=s.error,o&&!u&&l(o),s}finally{(!o||u||s(o))&&n(o)}}function n(t){return'OK'!==t?.addWishlistItem?.statusCode}function o(t){return'OK'!==t?.batchDeleteWishlistItemsByWishlistItemId?.statusCode}},"e3a3dd",["6668de","44059a"]);
__d(function(g,r,i,a,m,_e,d){"use strict";var t=r(d[0]).default;function e(){const t=r(d[1]);return e=function(){return t},t}Object.defineProperty(_e,"__esModule",{value:!0}),_e.SAVE_TO_LIST_LOCALSTORAGE_UPDATE_KEY=void 0,_e.broadcastSaveToListUpdate=function(){const t=(0,e().v4)();if((0,_.default)()){try{window.sessionStorage?.setItem(o.LAST_UPDATE_SESSION_STORAGE_KEY,t)}catch{}try{window.localStorage.setItem(n,t)}catch(t){}}};var _=t(r(d[2])),o=r(d[3]);const n=_e.SAVE_TO_LIST_LOCALSTORAGE_UPDATE_KEY='save_to_list_update'},"e3accc",["ba7a76","305dd5","c916d0","8e0668"]);
__d(function(g,r,i,a,m,e,d){"use strict";var t=r(d[0]).default;Object.defineProperty(e,"__esModule",{value:!0}),e.usePrewarmWishlistItems=function({items:t,cacheKey:n}){const{networkCacheVersion:l}=(0,o.useReadUIState)(p.SaveToListModalUIKey),[{seenAsyncQueryItems:y,tenantIntegrationInitialNetworkCacheVersion:c},f]=(0,o.useUIState)(h.WishlistItemsAsyncQueryUIKey),U=(0,s.useMemo)(()=>{if(!t||!n)return null;const s=c.get(n);return null!=s?s:(c.set(n,l),l)},[t,n,l,c]),M=Boolean(U&&l>U),v=(0,s.useMemo)(()=>!t||M?null:t.flatMap(({entityType:t,entityId:s,wishlistItems:n})=>null!=s&&n?n.filter(I.default).map(n=>({...n,productType:u.EntityTypeToProductType[t],productId:(0,T.getEntityId)(s)})):[]),[M,t]);(0,w.useMergeWishlistItems)(v),(0,s.useEffect)(()=>{if(null==t)return;const s=new Set(t.flatMap(({entityType:t,entityId:s,wishlistItems:n})=>null==s||null==n?[]:[S(t,(0,T.getEntityId)(s))]).filter(t=>!y.has(t)));s.size&&f(t=>({...t,seenAsyncQueryItems:new Set([...t.seenAsyncQueryItems,...s])}))},[t,U,l,y,f])},e.useWishlistItemsAsyncQuery=function(){const t=(0,o.useUpdateUIState)(f.SaveToListHeartsUIKey),T=(0,o.useUpdateUIState)(h.WishlistItemsAsyncQueryUIKey),U=(0,o.useUIStateGetter)(h.WishlistItemsAsyncQueryUIKey),{networkCacheVersion:M}=(0,o.useReadUIState)(p.SaveToListModalUIKey),v=(0,s.useRef)([]),[A,Q]=(0,s.useState)(null),[{listingIds:E,listingType:W},K]=(0,s.useState)({listingIds:[],listingType:'HOME'}),{data:k,loading:C}=(0,n().useClientSideQuery)(l.default,{variables:{listingIds:E,listingType:W,networkCacheVersion:M},skip:!c.default.isLoggedIn()||0===E.length}),_=(0,s.useMemo)(()=>C?void 0:k?.presentation?.wishlistItemsInfo?.filter(I.default).flatMap(({listingId:t,wishlistItems:s})=>s?.filter(I.default).map(s=>({__typename:'WishlistItem',deletedAt:null,productId:t,productType:W,version:null,wishlistId:s.wishlistId,wishlistItemId:s.wishlistItemId,wishlistName:null}))),[k?.presentation?.wishlistItemsInfo,W,C]),b=(0,y.default)(()=>{if(null==A&&v.current.length>0){const{entityType:t}=v.current[0];Q(v.current.filter(s=>s.entityType===t)),v.current=v.current.filter(s=>s.entityType!==t)}},100),L=(0,s.useCallback)((t,s)=>{if(!s)return;const{seenAsyncQueryItems:n}=U(),l=S(t,s);n.has(l)||(v.current.push({entityType:t,entityId:s}),T(t=>({...t,seenAsyncQueryItems:new Set([...t.seenAsyncQueryItems,l])})),b())},[U,b,T]);(0,s.useEffect)(()=>{t(t=>({...t,onSaveableEntityRead:L}))},[L,t]),(0,w.useMergeWishlistItems)(_),(0,s.useEffect)(()=>{if(A&&!C){const{entityType:t}=A[0],s=u.EntityTypeToProductType[t];K({listingIds:A.map(({entityId:t})=>t),listingType:s}),Q(null),b()}},[A,C,b])};var s=r(d[1]);function n(){const t=r(d[2]);return n=function(){return t},t}var l=t(r(d[3])),u=r(d[4]),y=t(r(d[5])),I=t(r(d[6])),o=r(d[7]),c=t(r(d[8])),f=r(d[9]),p=r(d[10]),h=r(d[11]),T=r(d[12]),w=r(d[13]);function S(t,s){return`${t}:${s}`}},"ef82e2",["ba7a76","07aa1f","068abc","ff5597","7ee7e4","5a0957","58861b","afdc80","06a99e","39dfae","f96184","648055","6a67c5","10c8a3"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SaveToListModalUIKey=e.DEFAULT_NETWORK_CACHE_VERSION=void 0;var t=r(d[0]);const l={visible:!1,activeEntity:null,newToast:null,newToastVisible:!1,unsaveNoteConfirmation:null,lists:null,requiresSignup:!1,wishlistItemIdToRemove:null,networkCacheVersion:e.DEFAULT_NETWORK_CACHE_VERSION=1};e.SaveToListModalUIKey=(0,t.createUIKey)('save-to-list-modal',{getDefault:()=>l})},"f96184",["005fd5"]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={name:'BatchDeleteWishlistItemsByWishlistItemIdMutation',type:'mutation',operationId:'30458ff942dbd7bcb643171c0c2c2a816108897e8e8f565fe8ae2d62ad1257e2'}},"f9f96a",[]);
__d(function(g,r,i,a,m,e,d){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={name:'WishlistItemsAsyncQuery',type:'query',operationId:'084d540359ef9152886c8fb7065f7905787a36849aeaf0c1cb629a518894c60c'}},"ff5597",[]);
__r("a9f4b1").extend({"shared.modal error":"An error occurred. Please try again later.","wishlist.toast_message_removed_from_wishlist":"Removed from %{bold_start}%{wishlist_name}%{bold_end}","wish_list.button.change_wish_list":"Change","wishlist.toast_message_saved_to_wishlist":"Saved to %{bold_start}%{wishlist_name}%{bold_end}"});
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/web/common/56a1.52c6cf79af.js.map